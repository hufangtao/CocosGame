{"version":3,"sources":["UIInviteFriend.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\ui","sourcesContent":["import { Home, Play } from \"../module/Modules\";\r\nimport GamePersist from \"../common/persist/GamePersist\";\r\nimport NetUtil from \"../common/net/NetUtil\";\r\nimport { Event_type } from \"../component/game/PlayDefine\";\r\nimport { UIFunc } from \"../common/UIFunc\";\r\nimport { RoomInviterS2C, RoomInviterC2S, RoomPlayWithC2S, RoomPlayWithS2C, RoomPlayConfirmC2S, RoomInviteRequestC2S } from \"../common/net/proto/mods/ProtoSectionRoom\";\r\nimport HomeManager from \"../component/page/home/HomeManager\";\r\nimport PlaymateHead from \"../component/prefab/PlaymateHead\";\r\nimport { RoomDispatcher } from \"../common/net/proto/ProtoDispatcher\";\r\nimport * as Misc from \"../common/Misc\";\r\nimport { DYNotify } from \"../../dyGame/DYNotify\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class UIInviteFriend extends cc.Component {\r\n\r\n  private static INVITE_WAITING: number = 1;\r\n  private static INVITE_CREATE: number = 2;\r\n  private static INIVTE_CLOSE: number = 3;\r\n\r\n  @property(cc.Node)\r\n  nodMyInfo: cc.Node = null;\r\n  @property(cc.Node)\r\n  nodOpponentInfo: cc.Node = null;\r\n  @property(cc.Node)\r\n  nodNoOpponent: cc.Node = null;\r\n\r\n  @property(PlaymateHead)\r\n  myPlayMateHead: PlaymateHead = null;\r\n  @property(PlaymateHead)\r\n  opponentPlayMateHead: PlaymateHead = null;\r\n\r\n  @property(cc.Button)\r\n  private btnStartPlay: cc.Button = null;\r\n\r\n  @property(cc.Button)\r\n  private btnCloseInvite: cc.Button = null;\r\n  @property(cc.Button)\r\n  private btnNewInvite: cc.Button = null;\r\n  @property(cc.Button)\r\n  private btnBack2: cc.Button = null;\r\n  @property(cc.RichText)\r\n  private labButton: cc.RichText = null;\r\n  @property(cc.RichText)\r\n  private labTip: cc.RichText = null;\r\n\r\n  @property(cc.SpriteFrame)\r\n  private spfMale: cc.SpriteFrame = null;\r\n  @property(cc.SpriteFrame)\r\n  private spfFemale: cc.SpriteFrame = null;\r\n\r\n  inviteeId;\r\n  inviterParam;\r\n  inviteStatus\r\n  public onEnable() {\r\n    DYNotify.regObserver(Event_type.GAMESTART, this.onNotify, this);\r\n    this.nodOpponentInfo.active = false;\r\n    this.nodNoOpponent.active = true;\r\n    this.initMyInfo();\r\n    this.labTip.string = '<b>' + '好友正在赶来的路上...' + '</b>';\r\n    this.labButton.string = '<b>' + '开始游戏' + '</b>';\r\n    this.btnStartPlay.interactable = false;\r\n    this.btnNewInvite.node.active = true;\r\n    this.btnBack2.node.active = false;\r\n  }\r\n\r\n  private onNotify(target, tag, param) {\r\n    var self = target;\r\n    if (tag == Event_type.GAMESTART) {\r\n      self.loadGameScene();\r\n    }\r\n  }\r\n  loadGameScene() {\r\n    cc.audioEngine.stopAll();\r\n\r\n    cc.log('loadGameScene');\r\n\r\n    cc.director.preloadScene('game', () => {\r\n      setTimeout(() => {\r\n        cc.director.loadScene('game');\r\n        UIFunc.closeUI('UIInviteFriend', () => { });\r\n      }, 50);\r\n    });\r\n  }\r\n  onDisable() {\r\n    this.inviteeId = null;\r\n    DYNotify.removeAllObservers(this);\r\n  }\r\n  public start() {\r\n\r\n  }\r\n\r\n  public set InviteStatus(val: number) {\r\n    if (this.inviteStatus === val) {\r\n      return;\r\n    }\r\n    const prevStatus = this.inviteStatus;\r\n    this.inviteStatus = val;\r\n    this.switchNodeActive();\r\n  }\r\n\r\n  private switchNodeActive() {\r\n    if (this.inviteStatus === UIInviteFriend.INIVTE_CLOSE) {\r\n      this.btnBack2.node.active = true;;\r\n      this.labButton.string = '<b>' + '房间关闭' + '</b>';\r\n      this.labTip.string = '<b>' + '房间关闭' + '</b>';\r\n      this.btnStartPlay.interactable = false;\r\n      this.btnNewInvite.node.active = false;\r\n      this.clearOpponentInfo();\r\n    }\r\n  }\r\n\r\n  initMyInfo() {\r\n    this.myPlayMateHead.HeadUrl = Home.DataPlayer.MyHeadUrl;\r\n    this.nodMyInfo.getChildByName('name').getComponent(cc.Label).string = Home.DataPlayer.MyName;\r\n\r\n    const nStarNum: number = Home.DataPlayer.FortuneStar;\r\n    const honerId: number = Misc.calcHonorId(nStarNum);\r\n    cc.loader.loadRes('res/rank/rank-' + honerId, cc.SpriteFrame, (err, spriteFrame) => {\r\n      this.nodMyInfo.getChildByName('rank').getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n    });\r\n\r\n    if (Home.DataPlayer.MySex == 1) {\r\n      this.nodMyInfo.getChildByName('sex').getComponent(cc.Sprite).spriteFrame = this.spfMale;\r\n    } else {\r\n      this.nodMyInfo.getChildByName('sex').getComponent(cc.Sprite).spriteFrame = this.spfFemale;\r\n    }\r\n  }\r\n  setOpponentInfo() {\r\n    this.nodOpponentInfo.active = true;\r\n    this.nodNoOpponent.active = false;\r\n    this.opponentPlayMateHead.HeadUrl = Play.DataPlay.OpponentHeadUrl;\r\n    this.nodOpponentInfo.getChildByName('name').getComponent(cc.Label).string = Play.DataPlay.OpponentName;\r\n\r\n    const nStarNum: number = Home.DataRoom.opponentPlaymate.star;\r\n    const honerId: number = Misc.calcHonorId(nStarNum);\r\n    cc.loader.loadRes('res/rank/rank-' + honerId, cc.SpriteFrame, (err, spriteFrame) => {\r\n      this.nodOpponentInfo.getChildByName('rank').getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n    });\r\n\r\n    if (Home.DataRoom.opponentPlaymate.sex == 1) {\r\n      this.nodOpponentInfo.getChildByName('sex').getComponent(cc.Sprite).spriteFrame = this.spfMale;\r\n    } else {\r\n      this.nodOpponentInfo.getChildByName('sex').getComponent(cc.Sprite).spriteFrame = this.spfFemale;\r\n    }\r\n  }\r\n  clearMyInfo() {\r\n    this.nodMyInfo.active = false;\r\n  }\r\n  clearOpponentInfo() {\r\n    this.nodOpponentInfo.active = false;\r\n    this.nodNoOpponent.active = true;\r\n  }\r\n\r\n  // 设置邀请者的参数\r\n  public makeInivterInfoRequest(inviterParam: string) {\r\n    // 不是被邀请者 不应该触发此处的逻辑\r\n    if (this.inviteeId !== Home.PlayerId) {\r\n      return;\r\n    }\r\n\r\n    this.inviterParam = inviterParam;\r\n    RoomDispatcher.on(RoomInviterS2C.EVENT_NAME, this.onReciveInviterInfo, this);\r\n    const roomInviter = new RoomInviterC2S();\r\n    roomInviter.inviterParam = inviterParam;\r\n    NetUtil.SendMsg(roomInviter);\r\n  }\r\n\r\n  // 收到邀请者的信息\r\n  private onReciveInviterInfo(data) {\r\n    const inviter: RoomInviterS2C = data;\r\n    if (inviter.inviterParam !== this.inviterParam) {\r\n      return;\r\n    }\r\n    RoomDispatcher.off(RoomInviterS2C.EVENT_NAME, this.onReciveInviterInfo, this);\r\n    const opponentPlaymate = inviter.playmate;\r\n    // this.showHeadImg(this.nodeOpponentHead, opponentPlaymate.id, opponentPlaymate.headImg);\r\n    if (Home.DataPlayer.MyId === opponentPlaymate.id) {\r\n      cc.log('这是我分享的链接');\r\n      UIFunc.closeUI('UIInviteFriend', () => { \r\n        HomeManager.INSTANCE.showHomeAd();\r\n      });\r\n      return;\r\n    }\r\n    Home.DataRoom.opponentPlaymate = opponentPlaymate;\r\n\r\n    this.setOpponentInfo();\r\n    this.makePlayWithRequest(inviter.inviterParam);\r\n  }\r\n\r\n  // 请求和邀请者进行对战\r\n  private makePlayWithRequest(inviterParam: string) {\r\n    const playWith = new RoomPlayWithC2S();\r\n    playWith.inviteeParam = inviterParam;\r\n    NetUtil.SendMsg(playWith);\r\n    RoomDispatcher.on(RoomPlayWithS2C.EVENT_NAME, this.onPlayWithReceived, this);\r\n  }\r\n\r\n  // 接受邀请的请求被处理\r\n  // 如果房间Id为0 表示房间已经关闭\r\n  // 如果房间Id不为0 则进行确认 等待邀请者确认后开始比赛\r\n  private onPlayWithReceived(data) {\r\n    cc.log('onPlayWithReceived');\r\n    RoomDispatcher.off(RoomPlayWithS2C.EVENT_NAME, this.onPlayWithReceived, this);\r\n    const playWith: RoomPlayWithS2C = data;\r\n    if (playWith.roomId > 0) {\r\n      console.log(\"play with room:\", playWith.roomId);\r\n    } else {\r\n      this.InviteStatus = UIInviteFriend.INIVTE_CLOSE;\r\n    }\r\n  }\r\n\r\n  // 比赛创建\r\n  public onPlayCreate() {\r\n    cc.log('onPlayCreate');\r\n    this.InviteStatus = UIInviteFriend.INVITE_CREATE;\r\n    // this.waitingTipsLabel.node.active = false;\r\n    this.labTip.string = '<b>' + '等待开始...' + '</b>';\r\n\r\n    if (this.inviteeId === Home.PlayerId) {\r\n      // 如果当前的玩家是被邀请者 则自动确认\r\n      this.makeConfirmRequest();\r\n      this.btnNewInvite.node.active = false;\r\n      this.btnStartPlay.interactable = false;\r\n      this.btnBack2.node.active = false;\r\n      this.labButton.string = '<b>' + '等待开始' + '</b>';\r\n    } else {\r\n      this.labButton.string = '<b>' + '开始游戏' + '</b>';\r\n      this.btnStartPlay.interactable = true;\r\n      this.btnNewInvite.node.active = false;\r\n      this.setOpponentInfo();\r\n    }\r\n  }\r\n  private makeConfirmRequest() {\r\n    const confirm = new RoomPlayConfirmC2S();\r\n    NetUtil.SendMsg(confirm);\r\n  }\r\n  // 返回大厅 取消邀请\r\n  public onCloseInvitePage() {\r\n    HomeManager.INSTANCE.hideHomeAd();\r\n    GamePersist.INSTANCE.btnAudio_1();\r\n    HomeManager.INSTANCE.makeInvisibleRequest();\r\n    UIFunc.closeUI('UIInviteFriend', () => {\r\n      HomeManager.INSTANCE.UIInviteFriend = null;\r\n      HomeManager.INSTANCE.showHomeAd();\r\n    });\r\n  }\r\n  public onOpponentLeave(playmateId: number) {\r\n    // GamePersist.INSTANCE.Toast(\"对方离开\");\r\n\r\n    if (this.inviteeId === Home.PlayerId) {\r\n      // 被邀请者进入房间关闭状态\r\n      this.InviteStatus = UIInviteFriend.INIVTE_CLOSE;\r\n      this.btnBack2.node.active = true;;\r\n      this.labButton.string = '<b>' + '房间关闭' + '</b>';\r\n      this.labTip.string = '<b>' + '房间关闭' + '</b>';\r\n      this.btnStartPlay.interactable = false;\r\n      this.clearOpponentInfo();\r\n    } else {\r\n      // 邀请者进入等待状态\r\n      this.InviteStatus = UIInviteFriend.INVITE_WAITING;\r\n      this.btnNewInvite.node.active = true;\r\n      this.btnStartPlay.interactable = false;\r\n      this.labButton.string = '<b>' + '开始游戏' + '</b>';\r\n      this.labTip.string = '<b>' + '对方离开' + '</b>';\r\n      this.clearOpponentInfo();\r\n    }\r\n  }\r\n  // 开始游戏\r\n  private onStartPlay() {\r\n    GamePersist.INSTANCE.btnAudio_1();\r\n    this.makeConfirmRequest();\r\n  }\r\n  private handleNewInvite() {\r\n    GamePersist.INSTANCE.btnAudio_1();\r\n    const inviteReq = new RoomInviteRequestC2S();\r\n    NetUtil.SendMsg(inviteReq);\r\n  }\r\n  public btnListener(event: cc.Event.EventTouch) {\r\n    var target = event.target;\r\n    switch (target.name) {\r\n      case 'btnBack2':\r\n      case 'btnBack':\r\n        this.onCloseInvitePage();\r\n        break;\r\n      case 'btnStartGame':\r\n        GamePersist.INSTANCE.blockInput();\r\n        this.onStartPlay();\r\n        break;\r\n      case 'btnInvite':\r\n        this.handleNewInvite();\r\n        break;\r\n    }\r\n  }\r\n}\r\n"]}
{"version":3,"sources":["Misc.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\common","sourcesContent":["import * as ConfigVO from \"./config/vo/ConfigVO\";\r\nimport * as Modules from \"../module/Modules\";\r\nimport PlaymateHead from \"../component/prefab/PlaymateHead\";\r\nimport { OpenHomeFrom } from \"./Defines\";\r\nimport { ProtoErrorCode } from \"./net/proto/ProtoReflect\";\r\n\r\n// 可索引的稀疏数组结构\r\nexport interface ISparseArr<T> {\r\n  [index: number]: T;\r\n}\r\n\r\nexport function goToPreload() {\r\n  cc.director.loadScene(\"preload\");\r\n}\r\n\r\n\r\nexport function goToHome(from: OpenHomeFrom = OpenHomeFrom.UI_LOGIN) {\r\n  cc.director.loadScene(\"home\");\r\n  Modules.Home.OpenHomeFrom = from;\r\n}\r\n\r\nexport interface ILvlDataGenerator<T> {\r\n  updateLvlData(template: T, lvl: number): T;\r\n}\r\n\r\nexport interface IPanel {\r\n  viewNode();\r\n}\r\n\r\nexport interface IRootUI {\r\n  showWaiting(node: cc.Node, msg?: string);\r\n  showPanel(panel: IPanel);\r\n  uiName(): string;\r\n  onAppHide();\r\n  onAppShow();\r\n}\r\n\r\nexport interface IAnimation {\r\n  config(name: string, frames: number, times: number);\r\n  play();\r\n}\r\n\r\nexport function setButtonSpriteFrame(button: cc.Button, spFrame: cc.SpriteFrame) {\r\n  const buttonSp: cc.Sprite = button.getComponent(cc.Sprite);\r\n  buttonSp.spriteFrame = spFrame;\r\n  buttonSp.enabled = false;\r\n  buttonSp.enabled = true;\r\n}\r\n\r\n// 根据星数计算荣耀段位\r\nexport function calcHonorId(star: number): number {\r\n  const rangeList: any[] = ConfigVO.Honor.getExtra(\"range\");\r\n  for (let i = 0; i < rangeList.length; i++) {\r\n    const range: number[] = rangeList[i];\r\n    const honorId = range[0];\r\n    const minStar = range[1];\r\n    if (star >= minStar) {\r\n      return honorId;\r\n    }\r\n  }\r\n}\r\n\r\n// 根据星数计算段位名称\r\nexport function getGradeName(star: number): string {\r\n  const maxStarList: number[] = ConfigVO.Honor.getExtra(\"max_star\");\r\n  const maxStar = maxStarList[0];\r\n  if (star >= maxStar) {\r\n    return \"最强王者\";\r\n  }\r\n  const sysHonorId: number = calcHonorId(star);\r\n  const sysHonor: ConfigVO.IHonorVO = ConfigVO.Honor.get(sysHonorId);\r\n  return sysHonor.name;\r\n}\r\n\r\nexport function calcShowStarCount(star: number): number {\r\n  let showStarNum: number = 0;\r\n  if (star > 0) {\r\n    const maxStarList: number[] = ConfigVO.Honor.getExtra(\"max_star\");\r\n    const maxStar = maxStarList[0];\r\n    if (star >= maxStar) {\r\n      showStarNum = 5;\r\n    } else {\r\n      showStarNum = star % 5;\r\n      if (showStarNum === 0) {\r\n        showStarNum = 5;\r\n      }\r\n    }\r\n  }\r\n  return showStarNum;\r\n}\r\n\r\nexport function formatDateTime(inputTime: number): string {\r\n  const date = new Date(inputTime);\r\n  const y = date.getFullYear();\r\n  const m = date.getMonth() + 1;\r\n  const strM = m < 10 ? (\"0\" + m) : (\"\" + m);\r\n  const d = date.getDate();\r\n  const strD = d < 10 ? (\"0\" + d) : (\"\" + d);\r\n  const h = date.getHours();\r\n  const strH = h < 10 ? (\"0\" + h) : (\"\" + h);\r\n  const min = date.getMinutes();\r\n  const strMin = min < 10 ? (\"0\" + min) : (\"\" + min);\r\n  const sec = date.getSeconds();\r\n  const strSec = sec < 10 ? (\"0\" + sec) : (\"\" + sec);\r\n  return y + \"-\" + strM + \"-\" + strD + \" \" + strH + \":\" + strMin + \":\" + strSec;\r\n}\r\n\r\nexport function showHeadImg(headNode: cc.Node, playmateId: number, headUrl: string) {\r\n  const playmateHead = PlaymateHead.GetComponent(headNode);\r\n  playmateHead.PlaymateId = playmateId;\r\n  playmateHead.HeadUrl = headUrl;\r\n}\r\n\r\n// 从数组中随机选择一个\r\nexport function randSelect<T>(items: T[]): T {\r\n  if (!items) {\r\n    return;\r\n  }\r\n  const cnt = items.length;\r\n  const index = Math.floor(cnt * Math.random());\r\n  return items[index];\r\n}\r\n\r\n// 随机一个主动分享内容\r\nexport function randManualShare(): ConfigVO.IShareVO {\r\n  return randShare(\"manual_list\");\r\n}\r\n\r\n// 随机一个邀请分享内容\r\nexport function randInviteShare(): ConfigVO.IShareVO {\r\n  return randShare(\"invite_list\");\r\n}\r\n\r\n// 随机一个炫耀分享内容\r\nexport function randFlauntShare(): ConfigVO.IShareVO {\r\n  return randShare(\"flaunt_list\");\r\n}\r\n\r\nexport function formatPercent(value: number): string {\r\n  return `${Math.floor(value * 100)}%`;\r\n}\r\n\r\n// 随机整数\r\nexport function getRandomInt(min, max) {\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\nfunction randShare(kind: string): ConfigVO.IShareVO {\r\n  const inviteList = ConfigVO.Share.getExtra(kind);\r\n  const shareId: number = randSelect(inviteList);\r\n  return ConfigVO.Share.get(shareId);\r\n}\r\n\r\nexport function protoErrMsg(code: number): string {\r\n  const msg = ProtoErrorCode[code];\r\n  if (!msg) {\r\n    return `ErrorCode:${code}`;\r\n  }\r\n  return msg;\r\n}\r\n\r\nexport function httpPost(url, params, callback) {\r\n  const xhr = cc.loader.getXMLHttpRequest();\r\n  xhr.onreadystatechange = function () {\r\n    cc.log(\"xhr.readyState=\" + xhr.readyState + \"  xhr.status=\" + xhr.status);\r\n    if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\r\n      const respone = xhr.responseText;\r\n      callback(respone);\r\n    } else {\r\n      callback(null);\r\n    }\r\n  };\r\n\r\n  xhr.open(\"POST\", url, true);\r\n  if (cc.sys.isNative) {\r\n    xhr.setRequestHeader(\"Accept-Encoding\", \"gzip,deflate\");\r\n  }\r\n  xhr.timeout = 5000; // 5 seconds for timeout  \r\n  xhr.send(params);\r\n} \r\n"]}
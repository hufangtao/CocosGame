{"version":3,"sources":["StateMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\component\\game\\pve","sourcesContent":["import { Play } from \"../../../module/Modules\";\r\nimport { GAME_MODEL } from \"../PlayDefine\";\r\n\r\nexport default class StateMgr extends cc.Component {\r\n    private static singleInstance: StateMgr;\r\n    public static get INSTANCE() {\r\n        if (!this.singleInstance) {\r\n            this.singleInstance = new StateMgr();\r\n        }\r\n        return this.singleInstance;\r\n    }\r\n\r\n    isGameBegin;\r\n    isTransportBegin;\r\n\r\n\r\n    isGameOver;\r\n\r\n    isStopOperate;\r\n\r\n    isBombOver;\r\n    isCollectOver;\r\n    isAnimalDownOver;\r\n    isTransportOver;\r\n    isAllDownOver;\r\n    isBonusActionOver;\r\n    isBonusOver;\r\n\r\n    isTimeLevel;\r\n\r\n    haveTransport;\r\n\r\n    init() {\r\n        this.isGameBegin = false;\r\n        this.isTransportBegin = false;\r\n\r\n        this.isGameOver = true;// 已经进入gameover\r\n        this.isStopOperate = false;\r\n\r\n        this.isAllDownOver = true;\r\n        this.isBombOver = true;\r\n        this.isCollectOver = true;// 宠物回收完成\r\n        this.isAnimalDownOver = true;\r\n        this.isTransportOver = true;\r\n        this.isBonusActionOver = false;\r\n        this.isBonusOver = false;\r\n\r\n        this.haveTransport = false;\r\n    }\r\n\r\n    \r\n    canTouch() {\r\n\r\n    }\r\n    canCompose() {\r\n\r\n    }\r\n\r\n    canAllDown() {\r\n        let canDown = true;\r\n        if (!this.isAllDownOver) {\r\n            canDown = false;\r\n        }\r\n        return canDown;\r\n    }\r\n    canCollect() {\r\n        let canCollect = true;\r\n        if (!this.isBombOver ) {\r\n            canCollect = false;\r\n        }\r\n        return canCollect;\r\n    }\r\n    canTransport() {\r\n        let canTransport = true;\r\n        if (!this.isBombOver  || !this.isAnimalDownOver || !this.isAllDownOver || this.isTransportBegin || Play.DataPve.canPetDown()) {\r\n            canTransport = false;\r\n        }\r\n        return canTransport;\r\n    }\r\n\r\n    /**\r\n     * 是否可操作\r\n     * 当时间和步数结束或者目标达成，禁止操作\r\n     */\r\n    canOperate() {\r\n        if(Play.GameModel == GAME_MODEL.PVP){\r\n            return true;\r\n        }\r\n        let canOperate = true;\r\n        if (Play.DataPve.levelData.grid.transport.length > 0) {\r\n            if (!this.isBombOver || !this.isAnimalDownOver || !this.isCollectOver\r\n                || !this.isTransportOver || !this.isAllDownOver) {\r\n                canOperate = false;\r\n            }\r\n        } else {\r\n            if(this.isStopOperate){\r\n                canOperate = false;\r\n            }\r\n        }\r\n\r\n        \r\n        return canOperate;\r\n    }\r\n\r\n    /**\r\n     * 可以进入游戏结束状态\r\n     * \r\n     * 前提是1.水果消除结束，2.水果合成结束，3.水果收集结束，4.技能释放完成，5.宠物收集完成，6.传送带结束，7.下落结束\r\n     * \r\n     * \r\n     */\r\n    canGameOver() {\r\n        let canGameOver = true;\r\n        // 动画是否播放完成\r\n        if (!this.isBombOver || !this.isCollectOver || !this.isAllDownOver || !this.isTransportOver\r\n            || !this.isGameOver) {\r\n            canGameOver = false;\r\n        }\r\n        // 步数或时间为0\r\n        // 目标完成\r\n        // 播放完成，时间未结束，目标未完成\r\n        if (canGameOver && !this.isStopOperate && !Play.DataPve.checkWin()) {\r\n            canGameOver = false;\r\n        }\r\n\r\n        // console.log('==================================================');\r\n        // console.log(this.isBombOver);\r\n        // console.log(this.isCollectOver);\r\n        // console.log(this.isAllDownOver);\r\n        return canGameOver;\r\n    }\r\n\r\n    canBonus() {\r\n        let canBonus = true;\r\n        if (!this.isBonusActionOver || this.isBonusOver || this.isTimeLevel) {\r\n            canBonus = false;\r\n        }\r\n        return canBonus;\r\n    }\r\n\r\n}\r\n"]}
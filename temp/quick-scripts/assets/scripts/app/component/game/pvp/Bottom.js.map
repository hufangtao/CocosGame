{"version":3,"sources":["Bottom.ts"],"names":[],"mappings":";;;;;AACA,mDAAqD;AACrD,oFAAoF;AACpF,uDAAkD;AAClD,yDAAwD;AACxD,mDAAkD;AAClD,wDAAuD;AAEjD,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAAQ,CAAmB;AAG5C;IAA4B,0BAAY;IADxC;QAAA,qEA8OC;QA1OG,iBAAW,GAAY,IAAI,CAAC;QAG5B,YAAM,GAAa,IAAI,CAAC;QAIjB,kBAAY,GAAG,EAAE,CAAC;QAEjB,kBAAY,GAAG,EAAE,CAAC;QAClB,kBAAY,GAAG,EAAE,CAAC;;IAgO9B,CAAC;IA9NG,uBAAM,GAAN;QACI,cAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;QAC3B,mBAAQ,CAAC,WAAW,CAAC,iBAAO,CAAC,yBAAyB,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;IACjF,CAAC;IAED,0BAAS,GAAT;QACI,mBAAQ,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC;IACtC,CAAC;IAED,qBAAI,GAAJ,UAAK,IAAI;QACL,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;IAC1B,CAAC;IAED,iCAAgB,GAAhB;QACI,IAAI,CAAC,YAAY,GAAG,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;QACjD,IAAI,CAAC,YAAY,GAAG,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;QACjD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,EAAE,CAAC,EAAE;YACrD,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;SAC/B;QACD,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,UAAU,EAAE,CAAC;IACtB,CAAC;IAED,YAAY;IACZ,iCAAgB,GAAhB;QACI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YACvD,IAAI,GAAG,GAAG,CAAC,CAAC;YACZ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAI,CAAC,UAAU,CAAC,eAAe,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;gBAC7D,IAAI,cAAI,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,CAAC,GAAG,CAAC,EAAE;oBACtD,GAAG,GAAG,cAAI,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;iBACrD;aACJ;YACD,IAAI,GAAG,GAAG,CAAC,EAAE;gBACT,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;aAC/B;SACJ;IACL,CAAC;IAED,WAAW;IACX,mCAAkB,GAAlB,UAAmB,KAAK;QACpB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;IACpC,CAAC;IAGD,WAAW;IACX,2BAAU,GAAV;QACI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YACvD,IAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAC;gBACvB,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;gBAC3I,SAAS;aACZ;YACD,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE;gBACvB,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACzI,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;gBACvC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,UAAU,GAAG,EAAE,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC;aAC/F;iBAAM,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE;gBAC7B,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACzI,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;gBACvC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,UAAU,GAAG,EAAE,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC;aAC/F;iBAAM;gBACH,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;gBAC3I,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,UAAU,GAAG,EAAE,CAAC,MAAM,CAAC,UAAU,CAAC,KAAK,CAAC;aAChG;SACJ;IACL,CAAC;IAED,QAAQ;IACR,0BAAS,GAAT,UAAU,KAAK;QACX,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC,EAAE;YAC/B,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;YAC1C,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;YAC3C,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;YACnD,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACrD,OAAO;SACV;aAAM,IAAI,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC,EAAE;YACrC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;YAC1C,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;YAC3C,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;YACnD,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACrD,OAAO;SACV;aAAM;SAEN;QACD,IAAI,OAAO,GAAG,KAAK,CAAC;QACpB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAI,CAAC,UAAU,CAAC,eAAe,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YAC7D,IAAI,cAAI,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,OAAO,KAAK,KAAK,EAAE;gBACtD,OAAO,GAAG,IAAI,CAAC;aAClB;SACJ;QACD,IAAI,CAAC,OAAO,EAAE;YACV,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;YAC1C,OAAM;SACT;QAED,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;IAC7B,CAAC;IAED,WAAW;IACX,6BAAY,GAAZ,UAAa,KAAK;QACd,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAExB,IAAI,iBAAiB,GAAG,IAAI,oCAAiB,EAAE,CAAC;QAChD,iBAAiB,CAAC,MAAM,GAAG,KAAK,CAAC;QACjC,iBAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;QAEnC,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC;QACrC,IAAI,CAAC,kBAAkB,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC;QACnC,sBAAsB;QAEtB,IAAI,IAAI,CAAC,SAAS,CAAC,KAAK,IAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE;YACjD,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACtC,IAAI,CAAC,UAAU,EAAE,CAAC;SACrB;IACL,CAAC;IAED,OAAO;IACP,uBAAM,GAAN,UAAO,KAAK;QAAZ,iBAmCC;QAlCG,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QACpG,IAAI,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAChG,KAAK,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACzB,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QAC3B,OAAO,CAAC,SAAS,GAAG,CAAC,CAAC;QAEtB,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC;QAErC,IAAI,EAAE,GAAG,CAAC,CAAC;QACX,IAAI,SAAS,GAAG,CAAC,CAAC;QAElB,IAAI,KAAK,GAAG,IAAI,CAAC,CAAA,KAAK;QACtB,IAAI,IAAI,GAAG,EAAE,CAAC,CAAA,MAAM;QAEpB,KAAK,CAAC,MAAM,GAAG,EAAE,GAAG,EAAE,CAAC;QAEvB,IAAI,EAAE,GAAG;YACL,OAAO,CAAC,SAAS,IAAI,KAAK,GAAG,IAAI,CAAC;YAClC,SAAS,IAAI,KAAK,CAAC;YACnB,IAAI,SAAS,IAAI,CAAC,EAAE;gBAChB,SAAS,GAAG,CAAC,CAAC;gBACd,EAAE,EAAE,CAAC;gBACL,KAAK,CAAC,MAAM,GAAG,EAAE,GAAG,EAAE,CAAC;aAC1B;QACL,CAAC,CAAA;QAED,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;QAEzB,IAAI,CAAC,YAAY,CAAC;YACd,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YAC5B,KAAK,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YAC1B,KAAI,CAAC,YAAY,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC;YACpC,KAAI,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;QACxB,CAAC,EAAE,IAAI,GAAG,KAAK,CAAC,CAAA;IACpB,CAAC;IAED,OAAO;IACP,yBAAQ,GAAR,UAAS,IAAI;QAAb,iBAmBC;QAlBG,QAAQ,IAAI,EAAE;YACV,KAAK,CAAC;gBACF,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,cAAc,CAAC;gBACpC,MAAM;YACV,KAAK,CAAC;gBACF,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,gBAAgB,CAAC;gBACtC,MAAM;YACV,KAAK,CAAC;gBACF,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,mBAAmB,CAAC;gBACzC,MAAM;YACV,KAAK,CAAC;gBACF,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,qBAAqB,CAAC;gBAC3C,MAAM;SACb;QACD,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;QAC3B,IAAI,CAAC,YAAY,CAAC;YACd,KAAI,CAAC,MAAM,CAAC,MAAM,GAAG,EAAE,CAAC;QAC5B,CAAC,EAAE,CAAC,CAAC,CAAA;IACT,CAAC;IAED,SAAS;IACT,iCAAgB,GAAhB;QACI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YACvD,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YAC3C,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACnD,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC;YAC/C,OAAO,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC;SACvD;IACL,CAAC;IAED,aAAa;IACb,gCAAe,GAAf,UAAgB,IAAI;QAChB,IAAI,OAAO,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC;QAClD,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACnD,IAAI,CAAC,YAAY,CAAC;YACd,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACnD,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,QAAQ,GAAG,CAAC,CAAC;YAC/C,OAAO,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC;QACxD,CAAC,EAAE,CAAC,CAAC,CAAC;IACV,CAAC;IAEM,4BAAW,GAAlB,UAAmB,KAA0B;QACzC,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;QAC1B,QAAQ,MAAM,CAAC,IAAI,EAAE;YACjB,KAAK,UAAU;gBACX,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;gBAClB,MAAM;YACV,KAAK,UAAU;gBACX,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;gBAClB,MAAM;YACV,KAAK,UAAU;gBACX,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;gBAClB,MAAM;YACV,KAAK,UAAU;gBACX,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;gBAClB,MAAM;SACb;IACL,CAAC;IAEO,yBAAQ,GAAhB,UAAiB,MAAM,EAAE,GAAG,EAAE,KAAK;QAC/B,IAAI,IAAI,GAAG,MAAM,CAAC;QAClB,IAAI,GAAG,IAAI,uBAAU,EAAE;YACnB,IAAI,CAAC,UAAU,EAAE,CAAC;SACrB;aAAM,IAAI,GAAG,IAAI,iBAAO,CAAC,yBAAyB,EAAE;YACjD,IAAI,CAAC,UAAU,EAAE,CAAC;SACrB;IACL,CAAC;IAzOD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;+CACU;IAG5B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;0CACK;IANf,MAAM;QADlB,OAAO;OACK,MAAM,CA6OlB;IAAD,aAAC;CA7OD,AA6OC,CA7O2B,EAAE,CAAC,SAAS,GA6OvC;AA7OY,wBAAM","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\component\\game\\pvp","sourcesContent":["import LayerGame from \"./LayerGame\";\r\nimport { Play, Home } from \"../../../module/Modules\";\r\nimport { PlayActiveBuffC2S } from \"../../../common/net/proto/mods/ProtoSectionPlay\";\r\nimport NetUtil from \"../../../common/net/NetUtil\";\r\nimport { BuffUpdate } from \"../../page/home/RoomDefine\";\r\nimport { Message } from \"../../../common/Message\";\r\nimport { DYNotify } from \"../../../../dyGame/DYNotify\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class Bottom extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    nodBuffSlot: cc.Node = null;\r\n\r\n    @property(cc.Label)\r\n    labTip: cc.Label = null;\r\n\r\n    public layerGame: LayerGame;\r\n\r\n    public canTouchSlot = [];\r\n\r\n    private propOwnState = [];\r\n    private propUseState = [];\r\n\r\n    onLoad() {\r\n        Play.DataPvp.bottom = this;\r\n        DYNotify.regObserver(Message.EVENT_MODULE_PLAYER_PRIZE, this.onNotify, this);\r\n    }\r\n\r\n    onDestroy() {\r\n        DYNotify.removeAllObservers(this);\r\n    }\r\n\r\n    init(game) {\r\n        this.layerGame = game;\r\n    }\r\n\r\n    initCanTouchSlot() {\r\n        this.propOwnState = [false, false, false, false];\r\n        this.propUseState = [false, false, false, false];\r\n        for (let i = 0; i < this.nodBuffSlot.childrenCount; ++i) {\r\n            this.canTouchSlot[i] = true;\r\n        }\r\n        this.initPropOwnState();\r\n        this.updateBuff();\r\n    }\r\n\r\n    // 初始化道具拥有状态\r\n    initPropOwnState() {\r\n        for (let i = 0; i < this.nodBuffSlot.children.length; ++i) {\r\n            let num = 0;\r\n            for (let j = 0; j < Home.DataPlayer.PlayerGoodsData.length; ++j) {\r\n                if (Home.DataPlayer.PlayerGoodsData[j].goodsId === i + 1) {\r\n                    num = Home.DataPlayer.PlayerGoodsData[j].goodsNum;\r\n                }\r\n            }\r\n            if (num > 0) {\r\n                this.propOwnState[i] = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 更新道具使用状态\r\n    updatePropUseState(index) {\r\n        this.propUseState[index] = true;\r\n    }\r\n\r\n\r\n    // 更新buff视图\r\n    updateBuff() {\r\n        for (let i = 0; i < this.nodBuffSlot.children.length; ++i) {\r\n            if(this.layerGame.pvpTeach){\r\n                this.nodBuffSlot.children[i].getChildByName('nodProp').getChildByName('propIcon').getComponent(cc.Sprite).setState(cc.Sprite.State.NORMAL);\r\n                continue;\r\n            }\r\n            if (!this.propOwnState[i]) {\r\n                this.nodBuffSlot.children[i].getChildByName('nodProp').getChildByName('propIcon').getComponent(cc.Sprite).setState(cc.Sprite.State.GRAY);\r\n                this.nodBuffSlot.children[i].scale = 1;\r\n                this.nodBuffSlot.children[i].getComponent(cc.Button).transition = cc.Button.Transition.NONE;\r\n            } else if (this.propUseState[i]) {\r\n                this.nodBuffSlot.children[i].getChildByName('nodProp').getChildByName('propIcon').getComponent(cc.Sprite).setState(cc.Sprite.State.GRAY);\r\n                this.nodBuffSlot.children[i].scale = 1;\r\n                this.nodBuffSlot.children[i].getComponent(cc.Button).transition = cc.Button.Transition.NONE;\r\n            } else {\r\n                this.nodBuffSlot.children[i].getChildByName('nodProp').getChildByName('propIcon').getComponent(cc.Sprite).setState(cc.Sprite.State.NORMAL);\r\n                this.nodBuffSlot.children[i].getComponent(cc.Button).transition = cc.Button.Transition.SCALE;\r\n            }\r\n        }\r\n    }\r\n\r\n    // 点击道具槽\r\n    clickSlot(index) {\r\n        if (!this.propOwnState[index - 1]) {\r\n            this.layerGame.PlayUI.Audio.buffInValid();\r\n            this.layerGame.PlayUI.setToast('你尚未拥有此技能');\r\n            let btnSlot = this.nodBuffSlot.children[index - 1];\r\n            btnSlot.getComponent(cc.Animation).play('PropShake');\r\n            return;\r\n        } else if (this.propUseState[index - 1]) {\r\n            this.layerGame.PlayUI.Audio.buffInValid();\r\n            this.layerGame.PlayUI.setToast('该技能本局已使用');\r\n            let btnSlot = this.nodBuffSlot.children[index - 1];\r\n            btnSlot.getComponent(cc.Animation).play('PropShake');\r\n            return;\r\n        } else {\r\n\r\n        }\r\n        let hadProp = false;\r\n        for (let i = 0; i < Home.DataPlayer.PlayerGoodsData.length; ++i) {\r\n            if (Home.DataPlayer.PlayerGoodsData[i].goodsId === index) {\r\n                hadProp = true;\r\n            }\r\n        }\r\n        if (!hadProp) {\r\n            this.layerGame.PlayUI.Audio.buffInValid();\r\n            return\r\n        }\r\n\r\n        this.sendBuffType(index);\r\n    }\r\n\r\n    // 发送buff类型\r\n    sendBuffType(index) {\r\n        this.stopAllTipAction();\r\n\r\n        let playActiveBuffC2S = new PlayActiveBuffC2S();\r\n        playActiveBuffC2S.slotId = index;\r\n        NetUtil.SendMsg(playActiveBuffC2S);\r\n\r\n        this.canTouchSlot[index - 1] = false;\r\n        this.updatePropUseState(index - 1);\r\n        // this.propCd(index);\r\n\r\n        if (this.layerGame.pvpAi || this.layerGame.pvpTeach) {\r\n            this.layerGame.PlayUI.iUseProp(index);\r\n            this.updateBuff();\r\n        }\r\n    }\r\n\r\n    // 道具cd\r\n    propCd(index) {\r\n        let sprMask = this.nodBuffSlot.children[index - 1].getChildByName('cdMask').getComponent(cc.Sprite);\r\n        let labCd = this.nodBuffSlot.children[index - 1].getChildByName('labCd').getComponent(cc.Label);\r\n        labCd.node.active = true;\r\n        sprMask.node.active = true;\r\n        sprMask.fillRange = 1;\r\n\r\n        this.canTouchSlot[index - 1] = false;\r\n\r\n        let cd = 5;\r\n        let oneSecede = 1;\r\n\r\n        let space = 0.05;// 间隔\r\n        let time = cd;//cd时间\r\n\r\n        labCd.string = cd + '';\r\n\r\n        let cb = function () {\r\n            sprMask.fillRange -= space / time;\r\n            oneSecede -= space;\r\n            if (oneSecede <= 0) {\r\n                oneSecede = 1;\r\n                cd--;\r\n                labCd.string = cd + '';\r\n            }\r\n        }\r\n\r\n        this.schedule(cb, space);\r\n\r\n        this.scheduleOnce(() => {\r\n            sprMask.node.active = false;\r\n            labCd.node.active = false;\r\n            this.canTouchSlot[index - 1] = true;\r\n            this.unschedule(cb);\r\n        }, time + space)\r\n    }\r\n\r\n    // 道具提示\r\n    propTips(type) {\r\n        switch (type) {\r\n            case 1:\r\n                this.labTip.string = '哇好多宠物，用这个超省事';\r\n                break;\r\n            case 2:\r\n                this.labTip.string = '或许它可以帮你不劳而获，嘿嘿';\r\n                break;\r\n            case 3:\r\n                this.labTip.string = '遮挡ta的视野可以影响ta的发挥哦';\r\n                break;\r\n            case 4:\r\n                this.labTip.string = '打乱ta的棋盘顺序可以影响ta的发挥哦';\r\n                break;\r\n        }\r\n        this.shakeSlotByType(type);\r\n        this.scheduleOnce(() => {\r\n            this.labTip.string = '';\r\n        }, 4)\r\n    }\r\n\r\n    // 停止所有动画\r\n    stopAllTipAction() {\r\n        for (let i = 0; i < this.nodBuffSlot.children.length; ++i) {\r\n            let btnSlot = this.nodBuffSlot.children[i];\r\n            btnSlot.getComponent(cc.Animation).stop('PropTip');\r\n            btnSlot.getChildByName('nodProp').rotation = 0;\r\n            btnSlot.getChildByName('guide-hand').active = false;\r\n        }\r\n    }\r\n\r\n    // 根据道具类型晃动道具\r\n    shakeSlotByType(type) {\r\n        let btnSlot = this.nodBuffSlot.children[type - 1];\r\n        btnSlot.getComponent(cc.Animation).play('PropTip');\r\n        this.scheduleOnce(() => {\r\n            btnSlot.getComponent(cc.Animation).stop('PropTip');\r\n            btnSlot.getChildByName('nodProp').rotation = 0;\r\n            btnSlot.getChildByName('guide-hand').active = false;\r\n        }, 4);\r\n    }\r\n\r\n    public btnListener(event: cc.Event.EventTouch) {\r\n        var target = event.target;\r\n        switch (target.name) {\r\n            case 'btnSlot1':\r\n                this.clickSlot(1);\r\n                break;\r\n            case 'btnSlot2':\r\n                this.clickSlot(2);\r\n                break;\r\n            case 'btnSlot3':\r\n                this.clickSlot(3);\r\n                break;\r\n            case 'btnSlot4':\r\n                this.clickSlot(4);\r\n                break;\r\n        }\r\n    }\r\n\r\n    private onNotify(target, tag, param) {\r\n        var self = target;\r\n        if (tag == BuffUpdate) {\r\n            self.updateBuff();\r\n        } else if (tag == Message.EVENT_MODULE_PLAYER_PRIZE) {\r\n            self.updateBuff();\r\n        }\r\n    }\r\n}"]}
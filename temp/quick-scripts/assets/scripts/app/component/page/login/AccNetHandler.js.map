{"version":3,"sources":["AccNetHandler.ts"],"names":[],"mappings":";;;;;AAAA,6EAA2F;AAC3F,kFAAyJ;AACzJ,2CAAsC;AACtC,mEAA8D;AAC9D,uEAAsF;AAEtF,sFAAiF;AAEjF;IAEE;QACE,+BAAa,CAAC,EAAE,CAAC,kCAAgB,CAAC,UAAU,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QACvE,+BAAa,CAAC,EAAE,CAAC,6BAAW,CAAC,UAAU,EAAO,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;QACrE,+BAAa,CAAC,EAAE,CAAC,8BAAY,CAAC,UAAU,EAAM,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;QACtE,+BAAa,CAAC,EAAE,CAAC,6BAAW,CAAC,UAAU,EAAO,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;QACrE,+BAAa,CAAC,EAAE,CAAC,+BAAa,CAAC,UAAU,EAAK,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QACvE,+BAAa,CAAC,EAAE,CAAC,gCAAc,CAAC,UAAU,EAAI,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QAExE,gFAAgF;QAChF,iCAAe,CAAC,EAAE,CAAC,iCAAa,CAAC,UAAU,EAAC,IAAI,CAAC,YAAY,EAAC,IAAI,CAAC,CAAC;IACtE,CAAC;IAED,eAAe;IACR,oCAAY,GAAnB,UAAoB,OAAO;QACzB,IAAM,UAAU,GAAkB,OAAO,CAAC;QAC1C,IAAM,YAAY,GAAG,UAAU,CAAC,IAAI,CAAC;QACrC,qBAAW,CAAC,QAAQ,CAAC,KAAK,CAAC,6BAAc,CAAC,YAAY,CAAC,CAAC,CAAC;IAC3D,CAAC;IAGD,UAAU;IACH,oCAAY,GAAnB,UAAoB,OAAO;QACzB,IAAM,UAAU,GAAqB,OAAO,CAAC;QAC7C,oDAAoD;QACpD,qBAAW,CAAC,QAAQ,CAAC,UAAU,GAAG,UAAU,CAAC,IAAI,CAAC;IACpD,CAAC;IAED,WAAW;IACJ,kCAAU,GAAjB,UAAkB,OAAO;QACvB,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QAChB,IAAM,QAAQ,GAAgB,OAAO,CAAC;QACtC,oBAAU,CAAC,QAAQ,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;IAClD,CAAC;IAEM,oCAAY,GAAnB,UAAoB,OAAO;QACzB,EAAE,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;QACvB,IAAM,UAAU,GAAkB,OAAO,CAAC;QAC1C,oBAAU,CAAC,QAAQ,CAAC,mBAAmB,CAAC,UAAU,CAAC,CAAC;IACtD,CAAC;IAED,WAAW;IACJ,mCAAW,GAAlB,UAAmB,OAAO;QACxB,IAAM,SAAS,GAAiB,OAAO,CAAC;QACxC,oBAAU,CAAC,QAAQ,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;IACpD,CAAC;IAED,YAAY;IACL,kCAAU,GAAjB,UAAkB,OAAO;QACvB,IAAM,QAAQ,GAAgB,OAAO,CAAC;QACtC,oBAAU,CAAC,QAAQ,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;IAClD,CAAC;IAEM,qCAAa,GAApB,UAAqB,OAAO;QAC1B,IAAM,WAAW,GAAmB,OAAO,CAAC;QAC5C,IAAM,WAAW,GAAG,WAAW,CAAC,IAAI,CAAC;QACrC,qBAAW,CAAC,QAAQ,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;IACjD,CAAC;IACH,oBAAC;AAAD,CA3DA,AA2DC,IAAA","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\component\\page\\login","sourcesContent":["import { AccDispatcher, DebugDispatcher } from \"../../../common/net/proto/ProtoDispatcher\";\r\nimport { AccServertimeS2C, AccLoginS2C, AccCreateS2C, AccEnterS2C, AccReloginS2C, AccMaintainS2C } from \"../../../common/net/proto/mods/ProtoSectionAcc\";\r\nimport AccManager from \"./AccManager\";\r\nimport GamePersist from \"../../../common/persist/GamePersist\";\r\nimport { ProtoSection, ProtoErrorCode } from \"../../../common/net/proto/ProtoReflect\";\r\nimport { IProtoError } from \"../../../common/Defines\";\r\nimport { DebugErrorS2C } from \"../../../common/net/proto/mods/ProtoSectionDebug\";\r\n\r\nexport default class AccNetHandler {\r\n\r\n  constructor() {\r\n    AccDispatcher.on(AccServertimeS2C.EVENT_NAME, this.onServerTime, this);\r\n    AccDispatcher.on(AccLoginS2C.EVENT_NAME,      this.onLoginS2C, this);\r\n    AccDispatcher.on(AccCreateS2C.EVENT_NAME,     this.onCreateS2C, this);\r\n    AccDispatcher.on(AccEnterS2C.EVENT_NAME,      this.onEnterS2C, this);\r\n    AccDispatcher.on(AccReloginS2C.EVENT_NAME,    this.onReLoginS2C, this);\r\n    AccDispatcher.on(AccMaintainS2C.EVENT_NAME,   this.onMaintainS2C, this);\r\n\r\n    // GamePersist.INSTANCE.OnProtoError(ProtoSection.acc, this.onProtoError, this);\r\n    DebugDispatcher.on(DebugErrorS2C.EVENT_NAME,this.onProtoError,this);\r\n  }\r\n\r\n  // 处理协议统一的错误码返回\r\n  public onProtoError(message) {\r\n    const protoError: DebugErrorS2C = message;\r\n    const protoErrCode = protoError.code;\r\n    GamePersist.INSTANCE.Toast(ProtoErrorCode[protoErrCode]);\r\n  }\r\n\r\n\r\n  // 收到服务器时间\r\n  public onServerTime(message) {\r\n    const serverTime: AccServertimeS2C = message;\r\n    // console.log(\"get server time:\", serverTime.time);\r\n    GamePersist.INSTANCE.ServerTime = serverTime.time;\r\n  }\r\n\r\n  // 收到登陆协议返回\r\n  public onLoginS2C(message) {\r\n    cc.log(message);\r\n    const loginS2C: AccLoginS2C = message;\r\n    AccManager.INSTANCE.onReceiveLoginS2C(loginS2C);\r\n  }\r\n\r\n  public onReLoginS2C(message) {\r\n    cc.log('onReLoginS2C');\r\n    const reloginS2C: AccReloginS2C = message;\r\n    AccManager.INSTANCE.onReceiveReLoginS2C(reloginS2C);\r\n  }\r\n\r\n  // 收到创建角色返回\r\n  public onCreateS2C(message) {\r\n    const createS2C: AccCreateS2C = message;\r\n    AccManager.INSTANCE.onReceiveCreateS2C(createS2C);\r\n  }\r\n\r\n  // 收到进入游戏的结果\r\n  public onEnterS2C(message) {\r\n    const enterS2C: AccEnterS2C = message;\r\n    AccManager.INSTANCE.onReceiveEnterS2C(enterS2C);\r\n  }\r\n\r\n  public onMaintainS2C(message) {\r\n    const maintianS2C: AccMaintainS2C = message;\r\n    const maintainMsg = maintianS2C.desc;\r\n    GamePersist.INSTANCE.showMaintain(maintainMsg);\r\n  }\r\n}\r\n"]}
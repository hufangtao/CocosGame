{"version":3,"sources":["PlayerNetHandler.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\component\\page\\home","sourcesContent":["import { BuffDispatcher, PlayerDispatcher, GoodsDispatcher, SignInDispatcher } from \"../../../common/net/proto/ProtoDispatcher\";\r\nimport {\r\n  PlayerSelfInfoS2C,\r\n  PlayerFortuneS2C,\r\n  PlayerPlayStatS2C,\r\n  PlayerPveStatS2C,\r\n  PlayerShareGameS2C\r\n} from \"../../../common/net/proto/mods/ProtoSectionPlayer\";\r\nimport HomeManager from \"./HomeManager\";\r\nimport GamePersist from \"../../../common/persist/GamePersist\";\r\nimport { ProtoSection } from \"../../../common/net/proto/ProtoReflect\";\r\nimport { IProtoError } from \"../../../common/Defines\";\r\nimport { Home } from \"../../../module/Modules\";\r\nimport { BuffBuffStatusS2C } from \"../../../common/net/proto/mods/ProtoSectionBuff\";\r\nimport { GoodsPullS2C, GoodsUpdateS2C } from \"../../../common/net/proto/mods/ProtoSectionGoods\";\r\nimport { PGoods, PPveStat } from \"../../../common/net/proto/ProtoType\";\r\nimport { DYNotify } from \"../../../../dyGame/DYNotify\";\r\nimport { Message } from \"../../../common/Message\";\r\nimport { SignInSignListS2C, SignInSignS2C } from \"../../../common/net/proto/mods/ProtoSectionSignIn\";\r\n\r\nexport default class PlayerNetHandler {\r\n  constructor() {\r\n    PlayerDispatcher.on(PlayerSelfInfoS2C.EVENT_NAME, this.onSelfInfo, this);\r\n    PlayerDispatcher.on(PlayerFortuneS2C.EVENT_NAME, this.onFortune, this);\r\n    PlayerDispatcher.on(PlayerPlayStatS2C.EVENT_NAME, this.onPlayStat, this);\r\n    PlayerDispatcher.on(PlayerPveStatS2C.EVENT_NAME, this.onPveStat, this);\r\n    PlayerDispatcher.on(PlayerShareGameS2C.EVENT_NAME, this.onShare, this);\r\n\r\n    BuffDispatcher.on(BuffBuffStatusS2C.EVENT_NAME, this.onBuffStatus, this);\r\n\r\n    GamePersist.INSTANCE.OnProtoError(ProtoSection.player, this.onProtoError, this);\r\n\r\n    SignInDispatcher.on(SignInSignListS2C.EVENT_NAME, this.onSignInSignList, this);\r\n    SignInDispatcher.on(SignInSignS2C.EVENT_NAME, this.onSignInSign, this);\r\n  }\r\n\r\n  // 签到列表\r\n  onSignInSignList(message) {\r\n    const signInSignList: SignInSignListS2C = message;\r\n    DYNotify.post(Message.SIGN_List,signInSignList);\r\n  }\r\n  // 签到列表\r\n  onSignInSign(message) {\r\n    const signInSign: SignInSignS2C = message;\r\n    DYNotify.post(Message.SIGN_RESULT,signInSign);\r\n  }\r\n\r\n  onBuffStatus(message) {\r\n    const buffStatus: BuffBuffStatusS2C = message;\r\n    const slotId = buffStatus.slotId;\r\n    const buffId = buffStatus.buffId;\r\n    const number = buffStatus.number;\r\n    HomeManager.INSTANCE.onBuffStatus(slotId, buffId, number);\r\n  }\r\n\r\n  onShare(message) {\r\n    const share: PlayerShareGameS2C = message;\r\n    HomeManager.INSTANCE.onReceiveShareGameS2C(share);\r\n    DYNotify.post(Message.GET_SHARE_CNT, share);\r\n  }\r\n\r\n  // 处理协议统一的错误码返回\r\n  public onProtoError(message) {\r\n    const protoError: IProtoError = message;\r\n    const protoErrMsg = protoError.errMsg;\r\n    GamePersist.INSTANCE.Toast(protoErrMsg);\r\n  }\r\n\r\n\r\n  public onSelfInfo(message) {\r\n    const selfInfo: PlayerSelfInfoS2C = message;\r\n    HomeManager.INSTANCE.onReceiveSelfInfoS2C(selfInfo);\r\n  }\r\n\r\n  public onFortune(message) {\r\n    const fortune: PlayerFortuneS2C = message;\r\n    const fortuneType: number = fortune.type;\r\n    const fortuneValue: number = fortune.val;\r\n    HomeManager.INSTANCE.onReceiveFortune(fortuneType, fortuneValue);\r\n  }\r\n\r\n  public onPlayStat(message) {\r\n    const playStat: PlayerPlayStatS2C = message;\r\n    const playCntTotal = playStat.stat.cntTotal;\r\n    const playCntWin = playStat.stat.cntWin;\r\n    const saveOnce = playStat.stat.saveOnce;\r\n    const matchOnce = playStat.stat.matchOnce;\r\n    const pveTotal = playStat.stat.pveTotal;\r\n    const pveWin = playStat.stat.pveWin;\r\n    const weeklyWin = playStat.stat.pvpWinOneweek;\r\n    const weeklyTotal = playStat.stat.pvpTotalOneweek;\r\n    const maxSuccessiveWin = playStat.stat.maxSuccessiveWin;\r\n    const level = playStat.stat.level;\r\n    const guide = playStat.stat.guide;\r\n    HomeManager.INSTANCE.onReceivePlayStat(playCntTotal, playCntWin, saveOnce, matchOnce, pveTotal, pveWin, weeklyWin, weeklyTotal, maxSuccessiveWin, level, guide);\r\n  }\r\n\r\n  public onPveStat(message) {\r\n    const pveStat: PlayerPveStatS2C = message;\r\n    const pveStatArray: PPveStat[] = pveStat.pvestat;\r\n    // console.log(pveStatArray);\r\n    HomeManager.INSTANCE.onReceivePveStat(pveStatArray);\r\n  }\r\n\r\n  // public onChatText(message) {\r\n  //   const chatText: ChatTextS2C = message;\r\n  // }\r\n}\r\n"]}
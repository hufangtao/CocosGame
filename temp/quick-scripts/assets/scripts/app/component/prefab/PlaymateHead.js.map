{"version":3,"sources":["PlaymateHead.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\component\\prefab","sourcesContent":["const { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class PlaymateHead extends cc.Component {\r\n\r\n  public static GetComponent(node: cc.Node): PlaymateHead {\r\n    return node.getComponent(\"PlaymateHead\");\r\n  }\r\n\r\n  @property(cc.Sprite)\r\n  private imgHead: cc.Sprite = null;\r\n\r\n  private playmateId: number = 0;\r\n  private headImgUrl: string;\r\n\r\n\r\n  public setSize(width, height) {\r\n    this.node.setContentSize(width, height);\r\n    this.imgHead.node.setContentSize(width, height);\r\n  }\r\n\r\n  public start() {\r\n  }\r\n\r\n  public showUnknownHead() {\r\n    this.imgHead.node.active = false;\r\n  }\r\n\r\n  // 设置头像的Url\r\n  public set HeadUrl(url: string) {\r\n    if (this.headImgUrl === url) {\r\n      return;\r\n    }\r\n    if (url.length < 1) {\r\n      return;\r\n    }\r\n    this.headImgUrl = url;\r\n\r\n    if (this.headImgUrl.substr(0, 5) == \"head_\") {\r\n      var ImgUrl = this.headImgUrl.substring(0, this.headImgUrl.lastIndexOf('.'));\r\n      cc.loader.loadRes(\"res/prefab/createRole/img_\" + ImgUrl, cc.SpriteFrame, (err, spriteFrame) => {\r\n        if (err) {\r\n          cc.warn(`load head img:${url} err:${err}`);\r\n          this.imgHead.node.active = false;\r\n          return;\r\n        }\r\n        this.imgHead.spriteFrame = spriteFrame;\r\n        // cc.loader.setAutoReleaseRecursively(spriteFrame, true)\r\n      });\r\n      return;\r\n    }\r\n\r\n    const remoteUrl = window['Partner'].HEAD_IMG_HOST + this.headImgUrl;\r\n    cc.loader.load(remoteUrl, (err, texture: cc.Texture2D) => {\r\n      if (err) {\r\n        cc.warn(`load head img:${url} err:${err}`);\r\n\r\n        this.imgHead.node.active = false;\r\n        return;\r\n      }\r\n      if (this.imgHead) {\r\n        this.imgHead.spriteFrame = new cc.SpriteFrame(texture);\r\n      }\r\n    });\r\n  }\r\n\r\n  public get PlaymateId(): number {\r\n    return this.playmateId;\r\n  }\r\n  public set PlaymateId(value: number) {\r\n    this.playmateId = value;\r\n  }\r\n}\r\n"]}
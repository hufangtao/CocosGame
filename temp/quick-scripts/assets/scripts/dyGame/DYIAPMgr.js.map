{"version":3,"sources":["DYIAPMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\dyGame","sourcesContent":["import DYUtils from './DYUtils';\r\nexport enum DYIAPEvent{\r\n    EVENT_INIT_SUCC = \"EVENT_INIT_SUCC\",\r\n    EVENT_INIT_FAIL = \"EVENT_INIT_FAIL\",\r\n    EVENT_PAY_SUCC = \"EVENT_PAY_SUCC\",\r\n    EVENT_PAY_FAIL = \"EVENT_PAY_FAIL\",\r\n    EVENT_REFUND_SUCC = \"EVENT_REFUND_SUCC\",\r\n    EVENT_REFUND_FAIL = \"EVENT_REFUND_FAIL\",\r\n}\r\n\r\nexport default class DYIAPMgr{\r\n    static init(param : any, listener : Function){\r\n        var self = this;\r\n        var param = param || {};\r\n\r\n        var tFuncListener = function(strEvent){\r\n            // DDLOG(\"tFuncListener in DYIAPMgr.init: {0}\", strEvent);\r\n            var et = JSON.parse(strEvent);\r\n            et.param = JSON.parse(et.param);\r\n\r\n            // et = {event:dy.login.EVENT_INIT_OK, param:{}}\r\n            if (listener){\r\n                listener(et);\r\n            }\r\n        }\r\n\r\n        var strParam = JSON.stringify(param);\r\n        var nListener = DYUtils.pushInvoke(tFuncListener);\r\n\r\n        if (cc.sys.isNative){\r\n            // 客户端版本\r\n            if (\"android\" == DYUtils.platform()){\r\n                // 安卓\r\n                jsb.reflection.callStaticMethod(\"com/dygame/common/DYIAPMgr\", \"init\", \"(Ljava/lang/String;I)V\", strParam, nListener);\r\n            }\r\n            else if (\"ios\" == DYUtils.platform()){\r\n                jsb.reflection.callStaticMethod(\"DYIAPMgr_iOS\", \"init:withListener:\", strParam, nListener.toString());\r\n            }\r\n            else{\r\n                // 其它版本\r\n                DYUtils.scheduleOnce(function(){\r\n                    var et = cc.js.createMap();\r\n                    et.event = DYIAPEvent.EVENT_INIT_SUCC;\r\n                    et.param = JSON.stringify({});\r\n                    DYUtils.popInvoke(nListener)(JSON.stringify(et));\r\n                }, 0.1);\r\n            }\r\n        }\r\n        else if (cc.sys.isBrowser){\r\n            // 浏览器版本\r\n        }\r\n    }\r\n\r\n    static pay(param : any, listener : Function){\r\n        var self = this;\r\n        var param = param || {};\r\n\r\n        var tFuncListener = function(strEvent){\r\n            // DDLOG(\"tFuncListener in DYIAPMgr.pay: {0}\", strEvent);\r\n\r\n            var et = JSON.parse(strEvent);\r\n            et.param = JSON.parse(et.param);\r\n\r\n            if (listener){\r\n                listener(et);\r\n            }\r\n        }\r\n\r\n        var strParam = JSON.stringify(param);\r\n        var nListener = DYUtils.pushInvoke(tFuncListener);\r\n\r\n        if (cc.sys.isNative){\r\n            // 客户端版本\r\n            if (\"android\" == DYUtils.platform()){\r\n                // 安卓\r\n                jsb.reflection.callStaticMethod(\"com/dygame/common/DYIAPMgr\", \"pay\", \"(Ljava/lang/String;I)V\", strParam, nListener);\r\n            }\r\n            else if (\"ios\" == DYUtils.platform()){\r\n                jsb.reflection.callStaticMethod(\"DYIAPMgr_iOS\", \"pay:withListener:\", strParam, nListener.toString());\r\n            }\r\n            else{\r\n                // 其它版本\r\n                // DDLOG(\"Not support on this native version, os = {0}\", cc.sys.os);\r\n\r\n                DYUtils.scheduleOnce(function(){\r\n                    var et = cc.js.createMap();\r\n                    et.event = DYIAPEvent.EVENT_PAY_FAIL;\r\n                    et.param = strParam;\r\n\r\n                    DYUtils.popInvoke(nListener)(JSON.stringify(et));\r\n                }, 0.1);\r\n            }\r\n        }\r\n        else if (cc.sys.isBrowser){\r\n           \r\n        }\r\n    }\r\n}"]}
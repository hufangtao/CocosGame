{"version":3,"sources":["DYLoginMgr.ts"],"names":[],"mappings":";;;;;AAAA,qCAAgC;AAEhC,IAAY,YAOX;AAPD,WAAY,YAAY;IACpB,mDAAoC,CAAA;IACvC,mDAAuC,CAAA;IACvC,qDAAwC,CAAA;IACxC,qDAAwC,CAAA;IACxC,uDAAyC,CAAA;IACzC,uDAAyC,CAAA;AAC1C,CAAC,EAPW,YAAY,GAAZ,oBAAY,KAAZ,oBAAY,QAOvB;AAED;IAAA;IA+IA,CAAC;IA9IU,eAAI,GAAX,UAAa,KAAW,EAAE,QAAmB;QACzC,IAAI,IAAI,GAAG,IAAI,CAAC;QACtB,IAAI,KAAK,GAAG,KAAK,IAAI,EAAE,CAAC;QAExB,IAAI,aAAa,GAAG,UAAS,QAAQ;YACpC,4DAA4D;YAC5D,IAAI,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;YAC9B,EAAE,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;YAEhC,gDAAgD;YAChD,IAAI,QAAQ,EAAC;gBACZ,QAAQ,CAAC,EAAE,CAAC,CAAC;aACb;QACF,CAAC,CAAA;QAGD,IAAI,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACrC,IAAI,SAAS,GAAG,iBAAO,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;QAElD,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,EAAC;YACnB,QAAQ;YACR,IAAI,SAAS,IAAI,iBAAO,CAAC,QAAQ,EAAE,EAAC;gBACnC,KAAK;gBACL,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,8BAA8B,EAAE,MAAM,EAAE,wBAAwB,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;aACvH;iBACI,IAAI,KAAK,IAAI,iBAAO,CAAC,QAAQ,EAAE,EAAC;gBACpC,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,oBAAoB,EAAE,QAAQ,EAAE,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAC;aACxG;iBACG;gBACH,OAAO;gBACP,iBAAO,CAAC,YAAY,CAAC;oBACpB,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,SAAS,EAAE,CAAC;oBAC3B,EAAE,CAAC,KAAK,GAAG,YAAY,CAAC,eAAe,CAAC;oBACxC,EAAE,CAAC,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;oBAC9B,iBAAO,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;gBAClD,CAAC,EAAE,GAAG,CAAC,CAAC;aACR;SACD;aACI,IAAI,EAAE,CAAC,GAAG,CAAC,SAAS,EAAC;YACzB,QAAQ;SACR;IACC,CAAC;IAED,KAAK;IACD,gBAAK,GAAZ,UAAc,KAAW,EAAE,QAAmB;QAC7C,IAAI,KAAK,GAAG,KAAK,IAAI,EAAE,CAAC;QAExB,IAAI,aAAa,GAAG,UAAS,QAAQ;YACpC,6DAA6D;YAC7D,IAAI,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;YAC9B,EAAE,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;YAEhC,IAAI,QAAQ,EAAC;gBACZ,QAAQ,CAAC,EAAE,CAAC,CAAC;aACb;QACF,CAAC,CAAA;QAGD,IAAI,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACrC,IAAI,SAAS,GAAG,iBAAO,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;QAElD,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,EAAC;YACnB,QAAQ;YACR,IAAI,SAAS,IAAI,iBAAO,CAAC,QAAQ,EAAE,EAAC;gBACnC,KAAK;gBACL,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,8BAA8B,EAAE,OAAO,EAAE,wBAAwB,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;aACxH;iBACI,IAAI,KAAK,IAAI,iBAAO,CAAC,QAAQ,EAAE,EAAC;gBACpC,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,qBAAqB,EAAE,QAAQ,EAAE,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAC;aACzG;iBACG;gBACH,iBAAO,CAAC,YAAY,CAAC;oBACpB,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,SAAS,EAAE,CAAC;oBAC3B,EAAE,CAAC,KAAK,GAAG,YAAY,CAAC,gBAAgB,CAAC;oBACzC,EAAE,CAAC,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC;wBACzB,EAAE,EAAG,EAAE;wBACP,KAAK,EAAG,EAAE;wBACV,IAAI,EAAG,EAAE;wBACT,KAAK,EAAG,EAAE;qBACV,CAAC,CAAC;oBACH,iBAAO,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC;gBAClD,CAAC,EAAE,GAAG,CAAC,CAAC;aACR;SACD;aACI,IAAI,EAAE,CAAC,GAAG,CAAC,SAAS,EAAC;YACzB,QAAQ;SACR;IACC,CAAC;IAEM,kBAAO,GAAd;QACF,OAAO,CAAC,iBAAO,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,MAAM,CAAC,CAAC;IACnD,CAAC;IAEM,oBAAS,GAAhB,UAAiB,KAAW,EAAE,QAAmB;QACnD,IAAI,KAAK,GAAG,KAAK,IAAI,EAAE,CAAC;QAExB,IAAI,aAAa,GAAG,UAAS,QAAQ;YACpC,iEAAiE;YACjE,IAAI,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;YAC9B,EAAE,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;YAEhC,IAAI,QAAQ,EAAC;gBACZ,QAAQ,CAAC,EAAE,CAAC,CAAC;aACb;QACF,CAAC,CAAA;QAGD,IAAI,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACrC,IAAI,SAAS,GAAG,iBAAO,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;QAElD,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,EAAC;YACnB,QAAQ;YACR,IAAI,SAAS,IAAI,iBAAO,CAAC,QAAQ,EAAE,EAAC;gBACnC,KAAK;gBACL,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,8BAA8B,EAAE,WAAW,EAAE,wBAAwB,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;aAC5H;iBACI,IAAI,KAAK,IAAI,iBAAO,CAAC,QAAQ,EAAE,EAAC;gBACpC,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,yBAAyB,EAAE,QAAQ,EAAE,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAC;aAC7G;SACD;aACI,IAAI,EAAE,CAAC,GAAG,CAAC,SAAS,EAAC;SACzB;IACF,CAAC;IAEM,iBAAM,GAAb,UAAc,KAAW;QACxB,IAAI,KAAK,GAAG,KAAK,IAAI,EAAE,CAAC;QAExB,IAAI,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACrC,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,EAAC;YACnB,QAAQ;YACR,IAAI,SAAS,IAAI,iBAAO,CAAC,QAAQ,EAAE,EAAC;gBACnC,KAAK;gBACL,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,8BAA8B,EAAE,QAAQ,EAAE,wBAAwB,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;aACjH;iBACI,IAAI,KAAK,IAAI,iBAAO,CAAC,QAAQ,EAAE,EAAC;gBACpC,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,sBAAsB,EAAE,QAAQ,EAAE,GAAG,CAAC,CAAC;aACzF;SACD;aACI,IAAI,EAAE,CAAC,GAAG,CAAC,SAAS,EAAC;SAEzB;IACF,CAAC;IACF,iBAAC;AAAD,CA/IA,AA+IC,IAAA;AA/IY,gCAAU","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\dyGame","sourcesContent":["import DYUtils from \"./DYUtils\";\r\n\r\nexport enum DYLoginEvent{\r\n    EVENT_INIT_SUCC \t= \"EVENT_INIT_SUCC\",\r\n\tEVENT_INIT_FAIL     = \"EVENT_INIT_FAIL\",\r\n\tEVENT_LOGIN_SUCC    = \"EVENT_LOGIN_SUCC\",\r\n\tEVENT_LOGIN_FAIL    = \"EVENT_LOGIN_FAIL\",\r\n\tEVENT_LOGOUT_SUCC   = \"EVENT_LOGOUT_SUCC\",\r\n\tEVENT_LOGOUT_FAIL   = \"EVENT_LOGOUT_FAIL\",\r\n}\r\n\r\nexport class DYLoginMgr{\r\n    static init (param : any, listener : Function){\r\n        var self = this;\r\n\t\tvar param = param || {};\r\n\r\n\t\tvar tFuncListener = function(strEvent){\r\n\t\t\t// DDLOG(\"tFuncListener in DYLoginMgr.init: {0}\", strEvent);\r\n\t\t\tvar et = JSON.parse(strEvent);\r\n\t\t\tet.param = JSON.parse(et.param);\r\n\r\n\t\t\t// et = {event:dy.login.EVENT_INIT_OK, param:{}}\r\n\t\t\tif (listener){\r\n\t\t\t\tlistener(et);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tvar strParam = JSON.stringify(param);\r\n\t\tvar nListener = DYUtils.pushInvoke(tFuncListener);\r\n\r\n\t\tif (cc.sys.isNative){\r\n\t\t\t// 客户端版本\r\n\t\t\tif (\"android\" == DYUtils.platform()){\r\n\t\t\t\t// 安卓\r\n\t\t\t\tjsb.reflection.callStaticMethod(\"com/dygame/common/DYLoginMgr\", \"init\", \"(Ljava/lang/String;I)V\", strParam, nListener);\r\n\t\t\t}\r\n\t\t\telse if (\"ios\" == DYUtils.platform()){\r\n\t\t\t\tjsb.reflection.callStaticMethod(\"DYLoginMgr_iOS\", \"init:withListener:\", strParam, nListener.toString());\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\t// 其它版本\r\n\t\t\t\tDYUtils.scheduleOnce(function(){\r\n\t\t\t\t\tvar et = cc.js.createMap();\r\n\t\t\t\t\tet.event = DYLoginEvent.EVENT_INIT_SUCC;\r\n\t\t\t\t\tet.param = JSON.stringify({});\r\n\t\t\t\t\tDYUtils.popInvoke(nListener)(JSON.stringify(et));\r\n\t\t\t\t}, 0.1);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (cc.sys.isBrowser){\r\n\t\t\t// 浏览器版本\r\n\t\t}\r\n    }\r\n\r\n    // 登录\r\n\tstatic login (param : any, listener : Function){\r\n\t\tvar param = param || {};\r\n\r\n\t\tvar tFuncListener = function(strEvent){\r\n\t\t\t// DDLOG(\"tFuncListener in DYLoginMgr.login: {0}\", strEvent);\r\n\t\t\tvar et = JSON.parse(strEvent);\r\n\t\t\tet.param = JSON.parse(et.param);\r\n\r\n\t\t\tif (listener){\r\n\t\t\t\tlistener(et);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tvar strParam = JSON.stringify(param);\r\n\t\tvar nListener = DYUtils.pushInvoke(tFuncListener);\r\n\r\n\t\tif (cc.sys.isNative){\r\n\t\t\t// 客户端版本\r\n\t\t\tif (\"android\" == DYUtils.platform()){\r\n\t\t\t\t// 安卓\r\n\t\t\t\tjsb.reflection.callStaticMethod(\"com/dygame/common/DYLoginMgr\", \"login\", \"(Ljava/lang/String;I)V\", strParam, nListener);\r\n\t\t\t}\r\n\t\t\telse if (\"ios\" == DYUtils.platform()){\r\n\t\t\t\tjsb.reflection.callStaticMethod(\"DYLoginMgr_iOS\", \"login:withListener:\", strParam, nListener.toString());\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tDYUtils.scheduleOnce(function(){\r\n\t\t\t\t\tvar et = cc.js.createMap();\r\n\t\t\t\t\tet.event = DYLoginEvent.EVENT_LOGIN_SUCC;\r\n\t\t\t\t\tet.param = JSON.stringify({\r\n\t\t\t\t\t\tid : \"\",\r\n\t\t\t\t\t\ttoken : \"\",\r\n\t\t\t\t\t\tname : \"\",\r\n\t\t\t\t\t\tparam : \"\"\r\n\t\t\t\t\t});\r\n\t\t\t\t\tDYUtils.popInvoke(nListener)(JSON.stringify(et));\r\n\t\t\t\t}, 0.1);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (cc.sys.isBrowser){\r\n\t\t\t// 浏览器版本\r\n\t\t}\r\n    }\r\n    \r\n    static isGuest() : boolean{\r\n\t\treturn (DYUtils.getParamExt(\"K_IS_GUEST\") == \"TRUE\");\r\n    }\r\n    \r\n    static regLogout(param : any, listener : Function){\r\n\t\tvar param = param || {};\r\n\r\n\t\tvar tFuncListener = function(strEvent){\r\n\t\t\t// DDLOG(\"tFuncListener in DYLoginMgr.regLogout: {0}\", strEvent);\r\n\t\t\tvar et = JSON.parse(strEvent);\r\n\t\t\tet.param = JSON.parse(et.param);\r\n\r\n\t\t\tif (listener){\r\n\t\t\t\tlistener(et);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tvar strParam = JSON.stringify(param);\r\n\t\tvar nListener = DYUtils.pushInvoke(tFuncListener);\r\n\r\n\t\tif (cc.sys.isNative){\r\n\t\t\t// 客户端版本\r\n\t\t\tif (\"android\" == DYUtils.platform()){\r\n\t\t\t\t// 安卓\r\n\t\t\t\tjsb.reflection.callStaticMethod(\"com/dygame/common/DYLoginMgr\", \"regLogout\", \"(Ljava/lang/String;I)V\", strParam, nListener);\r\n\t\t\t}\r\n\t\t\telse if (\"ios\" == DYUtils.platform()){\r\n\t\t\t\tjsb.reflection.callStaticMethod(\"DYLoginMgr_iOS\", \"regLogout:withListener:\", strParam, nListener.toString());\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (cc.sys.isBrowser){\r\n\t\t}\r\n\t}\r\n\r\n\tstatic logout(param : any){\r\n\t\tvar param = param || {};\r\n\r\n\t\tvar strParam = JSON.stringify(param);\r\n\t\tif (cc.sys.isNative){\r\n\t\t\t// 客户端版本\r\n\t\t\tif (\"android\" == DYUtils.platform()){\r\n\t\t\t\t// 安卓\r\n\t\t\t\tjsb.reflection.callStaticMethod(\"com/dygame/common/DYLoginMgr\", \"logout\", \"(Ljava/lang/String;I)V\", strParam, 0);\r\n\t\t\t}\r\n\t\t\telse if (\"ios\" == DYUtils.platform()){\r\n\t\t\t\tjsb.reflection.callStaticMethod(\"DYLoginMgr_iOS\", \"logout:withListener:\", strParam, \"0\");\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (cc.sys.isBrowser){\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n}\r\n"]}
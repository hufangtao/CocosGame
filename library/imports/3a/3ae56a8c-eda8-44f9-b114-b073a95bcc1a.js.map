{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\component\\game/assets\\scripts\\app\\component\\game\\PlayNetHandler.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\component\\game","sourcesContent":["import {\r\n    PlaySaveAnimalS2C,\r\n    PlayReadyS2C,\r\n    PlayNewRoundS2C,\r\n    PlayContinueS2C,\r\n    PlayNewPhaseS2C,\r\n    PlayStartPveS2C, PlayGenBlockS2C, PlayActiveBuffS2C, PlayStolenAnimalS2C, PlayBoardStatusS2C\r\n} from \"../../common/net/proto/mods/ProtoSectionPlay\";\r\nimport {\r\n    RoomPlayFinishS2C,\r\n    RoomOpponentLeaveS2C,\r\n    RoomReadyTimeoutS2C\r\n} from \"../../common/net/proto/mods/ProtoSectionRoom\";\r\nimport {PlayDispatcher, RoomDispatcher, RankDispatcher, GoodsDispatcher} from \"../../common/net/proto/ProtoDispatcher\";\r\nimport PlayManager from \"./PlayManager\";\r\nimport PlaymateHead from \"../prefab/PlaymateHead\";\r\nimport {RankPveRankS2C} from \"../../common/net/proto/mods/ProtoSectionRank\";\r\nimport {PveDataRank} from \"../../module/data/mod/DataRank\";\r\nimport {Home} from \"../../module/Modules\";\r\nimport * as Modules from \"../../module/Modules\";\r\nimport HomeManager from \"../page/home/HomeManager\";\r\nimport { GoodsPullS2C, GoodsUpdateS2C } from \"../../common/net/proto/mods/ProtoSectionGoods\";\r\nimport { PGoods } from \"../../common/net/proto/ProtoType\";\r\nimport { Message } from \"../../common/Message\";\r\nimport { DYNotify } from \"../../../dyGame/DYNotify\";\r\n\r\n\r\nexport default class PlayNetHandler {\r\n    constructor() {\r\n        PlayDispatcher.on(PlaySaveAnimalS2C.EVENT_NAME, this.onSaveAnimalResponse, this);\r\n        PlayDispatcher.on(PlayGenBlockS2C.EVENT_NAME, this.onGenBlockResponse, this);\r\n        PlayDispatcher.on(PlayReadyS2C.EVENT_NAME, this.onReadyResponse, this);\r\n        PlayDispatcher.on(PlayNewRoundS2C.EVENT_NAME, this.onNewRoundResponse, this);\r\n        PlayDispatcher.on(PlayContinueS2C.EVENT_NAME, this.onContinueResponse, this);\r\n        PlayDispatcher.on(PlayNewPhaseS2C.EVENT_NAME, this.onNewPhaseResponse, this);\r\n\r\n        PlayDispatcher.on(PlayStartPveS2C.EVENT_NAME, this.onStartPve, this);\r\n        PlayDispatcher.on(PlayActiveBuffS2C.EVENT_NAME, this.onActiveBuffResponse, this);\r\n        PlayDispatcher.on(PlayStolenAnimalS2C.EVENT_NAME, this.onStolenAnimalResponse, this);\r\n        PlayDispatcher.on(PlayBoardStatusS2C.EVENT_NAME, this.onBoardStatusResponse, this);\r\n\r\n        RoomDispatcher.on(RoomReadyTimeoutS2C.EVENT_NAME, this.onReadyTimeout, this);\r\n        RoomDispatcher.on(RoomPlayFinishS2C.EVENT_NAME, this.onPlayFinish, this);\r\n        RoomDispatcher.on(RoomOpponentLeaveS2C.EVENT_NAME, this.onOpponentLeave, this);\r\n        RankDispatcher.on(RankPveRankS2C.EVENT_NAME, this.onPveRankDataReceived, this);\r\n\r\n        \r\n    }\r\n\r\n    \r\n\r\n    private onSaveAnimalResponse(message) {\r\n        const sveAnimalS2C: PlaySaveAnimalS2C = message;\r\n        PlayManager.INSTANCE.getAnimalResponse(sveAnimalS2C);\r\n    }\r\n\r\n    private onGenBlockResponse(message){\r\n        const genBlockS2C: PlayGenBlockS2C = message;\r\n        PlayManager.INSTANCE.genBlockResponse(genBlockS2C);\r\n    }\r\n\r\n    private onReadyResponse(message) {\r\n        const playReadyS2C: PlayReadyS2C = message;\r\n        PlayManager.INSTANCE.onReadyResponse(playReadyS2C);\r\n    }\r\n\r\n    private onContinueResponse(message) {\r\n        const playContinueS2C: PlayContinueS2C = message;\r\n        PlayManager.INSTANCE.onContinueResponse(playContinueS2C);\r\n    }\r\n\r\n    private onNewRoundResponse(message) {\r\n        const newRoundS2C: PlayNewRoundS2C = message;\r\n        PlayManager.INSTANCE.newRound(newRoundS2C);\r\n\r\n    }\r\n\r\n    private onNewPhaseResponse(message) {\r\n        const newPhaseS2C: PlayNewPhaseS2C = message;\r\n        PlayManager.INSTANCE.newPhase(newPhaseS2C);\r\n    }\r\n\r\n    private onStartPve(message) {\r\n        const startPveS2C: PlayStartPveS2C = message;\r\n        PlayManager.INSTANCE.startPve(startPveS2C);\r\n    }\r\n\r\n    public onReadyTimeout(message) {\r\n        // 此时提醒准备时间超时，\r\n        PlayManager.INSTANCE.onBack();\r\n    }\r\n\r\n    // 一局结束\r\n    private onPlayFinish(message) {\r\n        const playResult: RoomPlayFinishS2C = message;\r\n        PlayManager.INSTANCE.onPlayFinish(playResult);\r\n    }\r\n\r\n    // 对手离开\r\n    private onOpponentLeave(message) {\r\n        const opponentLeave: RoomOpponentLeaveS2C = message;\r\n        //console.log(\"####################onOpponentLeave\");\r\n        if (!PlayManager.INSTANCE.PlayUI) {\r\n            return;\r\n        }\r\n        PlayManager.INSTANCE.onOpponentLeave();\r\n    }\r\n\r\n    public onPveRankDataReceived(message) {\r\n        const rankData: RankPveRankS2C = message;\r\n        // Home.PveRank = new PveDataRank();\r\n        // Home.PveRank.GlobalRankData = rankData.playmates;\r\n        // Home.PveRank.MyRank = rankData.myPos;\r\n        cc.log('RANK_RESULT')\r\n        DYNotify.post(Message.RANK_RESULT, rankData);\r\n    }\r\n\r\n    public onActiveBuffResponse(message){\r\n        const buffData: PlayActiveBuffS2C = message;\r\n        PlayManager.INSTANCE.onActiveBuff(buffData);\r\n    }\r\n\r\n    public onStolenAnimalResponse(message){\r\n        const stolenAnimalData: PlayStolenAnimalS2C = message;\r\n        PlayManager.INSTANCE.onStolenAnimal(stolenAnimalData);\r\n    }\r\n\r\n    public onBoardStatusResponse(message){\r\n        const playBoardStatus: PlayBoardStatusS2C = message;\r\n        PlayManager.INSTANCE.onBoardStatusResponse(playBoardStatus);\r\n    }\r\n}\r\n"]}
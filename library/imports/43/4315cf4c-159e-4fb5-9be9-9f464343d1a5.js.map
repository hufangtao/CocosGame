{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\common\\loader/assets\\scripts\\app\\common\\loader\\LoadItem.ts"],"names":[],"mappings":";;;;;AAAA,2CAAqF;AAErF;IAcE,kBAAY,IAAY,EAAE,QAAyB,EAAE,GAAY,EAAE,SAAgD;QAF3G,WAAM,GAAY,KAAK,CAAC;QAG9B,IAAI,CAAC,IAAI,GAAQ,IAAI,CAAC;QACtB,IAAI,CAAC,OAAO,GAAK,GAAG,CAAC;QACrB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,QAAQ,GAAI,QAAQ,IAAI,2BAAc,CAAC,MAAM,CAAC;QACnD,IAAI,CAAC,MAAM,GAAM,2BAAc,CAAC,IAAI,CAAC;IACvC,CAAC;IAEM,sBAAG,GAAV;QACE,OAAO,IAAI,CAAC,OAAO,CAAC;IACtB,CAAC;IAEM,uBAAI,GAAX;QACE,IAAI,CAAC,MAAM,GAAG,2BAAc,CAAC,OAAO,CAAC;QACrC,IAAM,IAAI,GAAG,IAAI,CAAC;QAClB,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,SAAS,EAAE,UAAS,KAAY,EAAE,QAAa;gBAC/E,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;YACzC,CAAC,CAAC,CAAC;SACJ;aAAM;YACL,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,UAAS,KAAY,EAAE,QAAa;gBAC/D,IAAI,CAAC,gBAAgB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;YACzC,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAEM,uBAAI,GAAX,UAAY,QAAmE;QAC7E,IAAI,CAAC,gBAAgB,GAAG,QAAQ,CAAC;IACnC,CAAC;IAEM,0BAAO,GAAd;QACE,IAAI,CAAC,MAAM,GAAG,2BAAc,CAAC,QAAQ,CAAC;QACtC,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;QAC7B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;IACpB,CAAC;IAEO,mCAAgB,GAAxB,UAAyB,KAAY,EAAE,QAAa;QAClD,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;IAC/C,CAAC;IACH,eAAC;AAAD,CArDA,AAqDC,IAAA","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\common\\loader","sourcesContent":["import { LoaderPriority, ILoadBatch, ILoadItem, LoadItemStatus } from \"./LoadDefine\";\r\n\r\nexport default class LoadItem implements ILoadItem {\r\n  public itemKey: string;\r\n  public path: string;\r\n  public assetType: typeof cc.Asset | typeof cc.RawAsset;\r\n  public priority: LoaderPriority;\r\n  public additionIndex: number;\r\n  public batch: ILoadBatch;\r\n  public status: LoadItemStatus;\r\n\r\n  private completeCallback: (loadItem: LoadItem, error: Error, resource: any) => void;\r\n  private loadBatch: ILoadBatch;\r\n\r\n  private filled: boolean = false;\r\n\r\n  constructor(path: string, priority?: LoaderPriority, key?: string, assetType?: typeof cc.Asset | typeof cc.RawAsset) {\r\n    this.path      = path;\r\n    this.itemKey   = key;\r\n    this.assetType = assetType;\r\n    this.priority  = priority || LoaderPriority.NORMAL;\r\n    this.status    = LoadItemStatus.IDLE;\r\n  }\r\n\r\n  public key() {\r\n    return this.itemKey;\r\n  }\r\n\r\n  public load() {\r\n    this.status = LoadItemStatus.STARTED;\r\n    const that = this;\r\n    if (this.assetType) {\r\n      cc.loader.loadRes(this.path, this.assetType, function(error: Error, resource: any) {\r\n        that.internalComplete(error, resource);\r\n      });\r\n    } else {\r\n      cc.loader.loadRes(this.path, function(error: Error, resource: any) {\r\n        that.internalComplete(error, resource);\r\n      });\r\n    }\r\n  }\r\n\r\n  public then(callback: (loadItem: LoadItem, error: Error, resource: any) => void) {\r\n    this.completeCallback = callback;\r\n  }\r\n\r\n  public dispose() {\r\n    this.status = LoadItemStatus.FINISHED;\r\n    this.completeCallback = null;\r\n    this.batch = null;\r\n  }\r\n\r\n  private internalComplete(error: Error, resource: any) {\r\n    this.completeCallback(this, error, resource);\r\n  }\r\n}\r\n"]}
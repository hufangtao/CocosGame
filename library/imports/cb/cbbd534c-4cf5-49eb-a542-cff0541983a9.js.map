{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\ui/assets\\scripts\\app\\ui\\UIAchievement.ts"],"names":[],"mappings":";;;;;AAAA,6CAA+C;AAC/C,6DAAwD;AAExD,gEAA2D;AAC3D,qCAAuC;AACvC,2DAAwD;AAIlD,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAAQ,CAAmB;AAG5C;IAA2C,iCAAY;IADvD;QAAA,qEAgKC;QA5JW,eAAS,GAAY,IAAI,CAAC;QAG1B,aAAO,GAAa,IAAI,CAAC;QAGzB,aAAO,GAAc,IAAI,CAAC,CAAM,SAAS;QAGzC,gBAAU,GAAY,IAAI,CAAC,CAAM,KAAK;QAGtC,aAAO,GAAY,IAAI,CAAC;QAExB,eAAS,GAAY,IAAI,CAAC;QAG1B,eAAS,GAAc,IAAI,CAAC,CAAI,KAAK;QAGrC,iBAAW,GAAc,IAAI,CAAC,CAAG,KAAK;QAGtC,oBAAc,GAAa,IAAI,CAAC;QAEhC,oBAAc,GAAa,IAAI,CAAC;QAEhC,2BAAqB,GAAa,IAAI,CAAC;QAEvC,wBAAkB,GAAa,IAAI,CAAC;QAEpC,oBAAc,GAAa,IAAI,CAAC;QAEhC,mBAAa,GAAa,IAAI,CAAC;QAE/B,cAAQ,GAAa,IAAI,CAAC;QAE1B,YAAM,GAAa,IAAI,CAAC;QAIxB,oBAAc,GAAc,IAAI,CAAC;QAEjC,oBAAc,GAAc,IAAI,CAAC;;IAiH7C,CAAC;IA/GU,8BAAM,GAAb;QAAA,iBAmEC;QAlEG,OAAO;QACP,IAAI,IAAI,GAAG,IAAI,CAAC;QAChB,IAAM,QAAQ,GAAW,cAAI,CAAC,UAAU,CAAC,WAAW,CAAC;QACrD,IAAM,OAAO,GAAW,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QACnD,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,gBAAgB,GAAG,OAAO,EAAE,EAAE,CAAC,WAAW,EAAE,UAAC,GAAG,EAAE,WAAW;YAC3E,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,WAAW,CAAC;YACvC,yDAAyD;QAC7D,CAAC,CAAC,CAAC;QACH,IAAM,WAAW,GAAG,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;QACrD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,WAAW,EAAE,CAAC,EAAE,EAAE;YACnC,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC;SACxD;QAED,QAAQ;QACR,qGAAqG;QAErG,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,8BAA8B,EAAE,EAAE,CAAC,MAAM,EAAE,UAAC,GAAG,EAAE,MAAM;YACrE,IAAI,OAAO,GAAG,EAAE,CAAC,WAAW,CAAC,MAAM,CAAC,CAAA;YACpC,OAAO,CAAC,MAAM,GAAG,KAAI,CAAC,SAAS,CAAC;YAChC,OAAO,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;YACzB,IAAM,YAAY,GAAqB,OAAO,CAAC,YAAY,CAAC,kBAAkB,CAAC,CAAC;YAChF,YAAY,CAAC,WAAW,CAAC,cAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;YACpD,YAAY,CAAC,aAAa,CAAC,qBAAQ,CAAC,GAAG,CAAC,CAAC;YACzC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;YAC3B,oDAAoD;QACxD,CAAC,CAAC,CAAA;QAGF,OAAO;QACP,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,cAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;QAC3C,IAAI,cAAI,CAAC,UAAU,CAAC,KAAK,IAAI,CAAC,EAAE;YAC5B,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;YAC3B,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC;SACjC;aAAM;YACH,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC;YAC5B,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC;SAChC;QAED,SAAS;QACT,IAAI,cAAI,CAAC,UAAU,CAAC,eAAe,KAAK,CAAC,EAAE;YACvC,IAAI,CAAC,qBAAqB,CAAC,MAAM,GAAG,GAAG,CAAC;SAC3C;aAAM;YACH,IAAM,UAAU,GAAG,cAAI,CAAC,UAAU,CAAC,aAAa,GAAG,cAAI,CAAC,UAAU,CAAC,eAAe,CAAC;YACnF,IAAI,CAAC,qBAAqB,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;SACtE;QAED,IAAI,cAAI,CAAC,UAAU,CAAC,YAAY,KAAK,CAAC,EAAE;YACpC,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,GAAG,CAAC;SACpC;aAAM;YACH,IAAM,UAAU,GAAG,cAAI,CAAC,UAAU,CAAC,UAAU,GAAG,cAAI,CAAC,UAAU,CAAC,YAAY,CAAC;YAC7E,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;SAC/D;QAED,SAAS;QACT,IAAI,cAAI,CAAC,UAAU,CAAC,YAAY,KAAK,CAAC,EAAE;YACpC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,CAAC;SAC5B;aAAM;YACH,IAAM,UAAU,GAAG,cAAI,CAAC,UAAU,CAAC,UAAU,GAAG,cAAI,CAAC,UAAU,CAAC,YAAY,CAAC;YAC7E,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;SACvD;QAED,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,KAAG,cAAI,CAAC,UAAU,CAAC,aAAe,CAAC;QAChE,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,KAAG,cAAI,CAAC,UAAU,CAAC,YAAc,CAAC;QAC9D,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,KAAG,cAAI,CAAC,UAAU,CAAC,YAAc,CAAC;QACzD,IAAI,CAAC,cAAc,CAAC,MAAM,GAAG,KAAG,cAAI,CAAC,UAAU,CAAC,YAAc,CAAC;QAC/D,IAAI,CAAC,kBAAkB,CAAC,MAAM,GAAG,KAAG,cAAI,CAAC,UAAU,CAAC,gBAAkB,CAAC;IAC3E,CAAC;IAEM,6BAAK,GAAZ;IACA,CAAC;IAED,OAAO;IACA,gCAAQ,GAAf;QACI,qBAAW,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;QAClC,IAAM,KAAK,GAAG,uBAAa,CAAC,QAAQ,CAAC,eAAe,EAAE,CAAC;QACvD,MAAM,CAAC,SAAS,CAAC,CAAC,QAAQ,CAAC,KAAK,EAAE,UAAU,IAAI;QAEhD,CAAC,CAAC,CAAC;IACP,CAAC;IAED,OAAO;IACA,gCAAQ,GAAf;QAAA,iBAQC;QAPG,qBAAW,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;QAClC,qBAAW,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,EAAE;YACzC,KAAI,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YACzB,KAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;YACpB,KAAI,CAAC,UAAU,EAAE,CAAC;QACtB,CAAC,CAAC,CAAC;IAEP,CAAC;IAED,kCAAU,GAAV;QACI,IAAI,MAAM,CAAC,SAAS,CAAC,CAAC,SAAS,EAAE,EAAE;YAC/B,MAAM,CAAC,SAAS,CAAC,CAAC,UAAU,EAAE,CAAC;SAClC;IACL,CAAC;IACD,aAAa;IACN,+BAAO,GAAd;QACI,qBAAW,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;QAClC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACxC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IAC3C,CAAC;IAED,aAAa;IACN,+BAAO,GAAd;QACI,qBAAW,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;QAClC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACxC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IAC3C,CAAC;IA1JD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;oDACgB;IAGlC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;kDACc;IAGjC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;kDACc;IAGlC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;qDACiB;IAGnC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;kDACc;IAEhC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;oDACgB;IAGlC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;oDACgB;IAGpC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;sDACkB;IAGtC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;yDACqB;IAExC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;yDACqB;IAExC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;gEAC4B;IAE/C;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;6DACyB;IAE5C;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;yDACqB;IAExC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;wDACoB;IAEvC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;mDACe;IAElC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;iDACa;IAIhC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;yDACqB;IAEzC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;yDACqB;IA9CxB,aAAa;QADjC,OAAO;OACa,aAAa,CA+JjC;IAAD,oBAAC;CA/JD,AA+JC,CA/J0C,EAAE,CAAC,SAAS,GA+JtD;kBA/JoB,aAAa","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\ui","sourcesContent":["import { Home, Play } from \"../module/Modules\";\r\nimport GamePersist from \"../common/persist/GamePersist\";\r\nimport NetUtil from \"../common/net/NetUtil\";\r\nimport SocialManager from \"../common/social/SocialManager\";\r\nimport * as Misc from \"../common/Misc\";\r\nimport { PlaySide } from \"../component/game/PlayDefine\";\r\nimport { PlayerShareGameC2S } from \"../common/net/proto/mods/ProtoSectionPlayer\";\r\nimport PlayPlaymateHead from \"../component/prefab/PlayPlaymateHead\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class UIAchievement extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    private headFrame: cc.Node = null;\r\n\r\n    @property(cc.Label)\r\n    private labName: cc.Label = null;\r\n\r\n    @property(cc.Sprite)\r\n    private spHoner: cc.Sprite = null;      // honer.\r\n\r\n    @property(cc.Node)\r\n    private pStartNode: cc.Node = null;      // 星数\r\n\r\n    @property(cc.Node)\r\n    private sprMale: cc.Node = null;\r\n    @property(cc.Node)\r\n    private sprFemale: cc.Node = null;\r\n\r\n    @property(cc.Button)\r\n    private pShareBtn: cc.Button = null;    // 分享\r\n\r\n    @property(cc.Button)\r\n    private pCloseLabel: cc.Button = null;   // 返回\r\n\r\n    @property(cc.Label)\r\n    private gameCountLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    private rateofWinLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    private rateofWinOneWeekLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    private successiveWinLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    private matchOnceLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    private saveOnceLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    private pveTotal: cc.Label = null;\r\n    @property(cc.Label)\r\n    private pveWin: cc.Label = null;\r\n\r\n\r\n    @property(cc.Sprite)\r\n    private pveAchievement: cc.Sprite = null;\r\n    @property(cc.Sprite)\r\n    private pvpAchievement: cc.Sprite = null;\r\n\r\n    public onLoad() {\r\n        // 玩家星数\r\n        var self = this;\r\n        const nStarNum: number = Home.DataPlayer.FortuneStar;\r\n        const honerId: number = Misc.calcHonorId(nStarNum);\r\n        cc.loader.loadRes('res/rank/rank-' + honerId, cc.SpriteFrame, (err, spriteFrame) => {\r\n            self.spHoner.spriteFrame = spriteFrame;\r\n            // cc.loader.setAutoReleaseRecursively(spriteFrame, true)\r\n        });\r\n        const showStarNum = Misc.calcShowStarCount(nStarNum);\r\n        for (let i = 1; i <= showStarNum; i++) {\r\n            this.pStartNode.getChildByName(\"\" + i).active = true;\r\n        }\r\n\r\n        // // 头像\r\n        // Misc.showHeadImg(this.pHeadNode, Modules.Home.DataPlayer.MyId, Modules.Home.DataPlayer.MyHeadUrl);\r\n\r\n        cc.loader.loadRes(\"prefab/play/PlayPlaymateHead\", cc.Prefab, (err, prefab) => {\r\n            var nodItem = cc.instantiate(prefab)\r\n            nodItem.parent = this.headFrame;\r\n            nodItem.setPosition(0, 0)\r\n            const playmateHead: PlayPlaymateHead = nodItem.getComponent(\"PlayPlaymateHead\");\r\n            playmateHead.setPlaymate(Home.DataPlayer.MyHeadUrl);\r\n            playmateHead.setColorFrame(PlaySide.RED);\r\n            playmateHead.setScale(1.2);\r\n            // cc.loader.setAutoReleaseRecursively(prefab, true)\r\n        })\r\n\r\n\r\n        // 玩家名字\r\n        this.labName.string = Play.DataPlay.MyName;\r\n        if (Home.DataPlayer.MySex == 1) {\r\n            this.sprMale.active = true;\r\n            this.sprFemale.active = false;\r\n        } else {\r\n            this.sprMale.active = false;\r\n            this.sprFemale.active = true;\r\n        }\r\n\r\n        // 单周对局胜率\r\n        if (Home.DataPlayer.PlayWeeklyTotal === 0) {\r\n            this.rateofWinOneWeekLabel.string = \"0\";\r\n        } else {\r\n            const winPercent = Home.DataPlayer.PlayWeeklyWin / Home.DataPlayer.PlayWeeklyTotal;\r\n            this.rateofWinOneWeekLabel.string = Misc.formatPercent(winPercent);\r\n        }\r\n\r\n        if (Home.DataPlayer.PlayCntTotal === 0) {\r\n            this.rateofWinLabel.string = \"0\";\r\n        } else {\r\n            const winPercent = Home.DataPlayer.PlayCntWin / Home.DataPlayer.PlayCntTotal;\r\n            this.rateofWinLabel.string = Misc.formatPercent(winPercent);\r\n        }\r\n\r\n        // pve成功率\r\n        if (Home.DataPlayer.PlayPveTotal === 0) {\r\n            this.pveWin.string = \"0\";\r\n        } else {\r\n            const winPercent = Home.DataPlayer.PlayPveWin / Home.DataPlayer.PlayPveTotal;\r\n            this.pveWin.string = Misc.formatPercent(winPercent);\r\n        }\r\n\r\n        this.matchOnceLabel.string = `${Home.DataPlayer.PlayMatchOnce}`;\r\n        this.saveOnceLabel.string = `${Home.DataPlayer.PlaySaveOnce}`;\r\n        this.pveTotal.string = `${Home.DataPlayer.PlayPveTotal}`;\r\n        this.gameCountLabel.string = `${Home.DataPlayer.PlayCntTotal}`;\r\n        this.successiveWinLabel.string = `${Home.DataPlayer.MaxSuccessiveWin}`;\r\n    }\r\n    \r\n    public start() {\r\n    }\r\n\r\n    // 分享按钮\r\n    public shareBtn(): void {\r\n        GamePersist.INSTANCE.btnAudio_1();\r\n        const param = SocialManager.INSTANCE.makeFlauntParam();\r\n        window['Partner'].doFlaunt(param, function (time) {\r\n\r\n        });\r\n    }\r\n\r\n    // 返回按钮\r\n    public closeBtn(): void {\r\n        GamePersist.INSTANCE.btnAudio_2();\r\n        GamePersist.INSTANCE.panelFadeOut(this.node, () => {\r\n            this.node.active = false;\r\n            this.node.destroy();\r\n            this.showHomeAd();\r\n        });\r\n\r\n    }\r\n\r\n    showHomeAd() {\r\n        if (window['Partner'].supportAd()) {\r\n            window['Partner'].showHomeAd();\r\n        }\r\n    }\r\n    // 显示pve模式的成就\r\n    public showPve(): void {\r\n        GamePersist.INSTANCE.btnAudio_1();\r\n        this.pvpAchievement.node.active = false;\r\n        this.pveAchievement.node.active = true;\r\n    }\r\n\r\n    // 显示pvp模式的成就\r\n    public showPvp(): void {\r\n        GamePersist.INSTANCE.btnAudio_1();\r\n        this.pveAchievement.node.active = false;\r\n        this.pvpAchievement.node.active = true;\r\n    }\r\n\r\n}\r\n"]}
{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\ui/assets\\scripts\\app\\ui\\UISign.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\app\\ui","sourcesContent":["import { SignInSignListC2S, SignInSignListS2C, SignInSignC2S, SignInSignS2C } from \"../common/net/proto/mods/ProtoSectionSignIn\";\r\nimport NetUtil from \"../common/net/NetUtil\";\r\nimport { UIFunc } from \"../common/UIFunc\";\r\nimport { DYNotify } from \"../../dyGame/DYNotify\";\r\nimport { Message } from \"../common/Message\";\r\nimport { PGoods } from \"../common/net/proto/ProtoType\";\r\nimport { slot } from \"../module/data/mod/DataPlayer\";\r\nimport GamePersist from \"../common/persist/GamePersist\";\r\nimport { ShareManager } from \"../common/ShareManager\";\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class UISign extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    nodSigns: cc.Node = null;\r\n    @property(cc.Toggle)\r\n    togDouble: cc.Toggle = null;\r\n    @property(cc.SpriteFrame)\r\n    spfCoin: cc.SpriteFrame = null;\r\n    @property(cc.SpriteFrame)\r\n    spfBox: cc.SpriteFrame = null;\r\n    @property(cc.SpriteFrame)\r\n    spfBuff1: cc.SpriteFrame = null;\r\n    @property(cc.SpriteFrame)\r\n    spfBuff2: cc.SpriteFrame = null;\r\n    @property(cc.SpriteFrame)\r\n    spfBuff3: cc.SpriteFrame = null;\r\n    @property(cc.SpriteFrame)\r\n    spfBuff4: cc.SpriteFrame = null;\r\n\r\n    @property(cc.Button)\r\n    btnSign: cc.Button = null;\r\n\r\n    currDay: number;\r\n    doubleStatus: boolean;\r\n\r\n    onLoad() {\r\n        this.togDouble.node.on('toggle', this.setToggleStatus, this)\r\n    }\r\n\r\n    onEnable() {\r\n        DYNotify.regObserver(Message.SIGN_List, this.onNotify, this);\r\n        DYNotify.regObserver(Message.SIGN_RESULT, this.onNotify, this);\r\n        this.notifySignList();\r\n        this.doubleStatus = true;\r\n        this.togDouble.isChecked = true;\r\n        this.canLoadUIGetProp = true;\r\n    }\r\n    onDisable() {\r\n        DYNotify.removeAllObservers(this);\r\n    }\r\n    setToggleStatus() {\r\n        this.doubleStatus = this.togDouble.isChecked;\r\n    }\r\n\r\n    // 请求签到列表\r\n    notifySignList() {\r\n        let signInSignList = new SignInSignListC2S();\r\n        NetUtil.SendMsg(signInSignList);\r\n    }\r\n\r\n    // 显示签到列表\r\n    showSignList(param: SignInSignListS2C) {\r\n        this.currDay = param.now;\r\n        for (let i = 0; i < param.list.length; ++i) {\r\n            let data = param.list[i];\r\n            let nodSign = this.nodSigns.children[data.slot - 1];\r\n            this.showSignReward(nodSign, data.reward);\r\n            if (data.slot > param.now) {\r\n                // 未来的签到\r\n                nodSign.getChildByName('nodAddSign').active = false;\r\n                nodSign.getChildByName('nodSigned').active = false;\r\n                nodSign.getChildByName('nodCurrDay').active = false;\r\n                nodSign.getChildByName('nodNormal').active = true;\r\n                nodSign.getComponent(cc.Button).interactable = false;\r\n            } else if (data.slot < param.now) {\r\n                // 过去的签到\r\n                // nodSign.getChildByName('nodAddSign').active = false;\r\n                // nodSign.getChildByName('nodSigned').active = false;\r\n                nodSign.getChildByName('nodCurrDay').active = false;\r\n                if (data.signed === 0) {\r\n                    // 漏签\r\n                    nodSign.getChildByName('nodNormal').active = false;\r\n                    nodSign.getChildByName('nodAddSign').active = true;\r\n                    nodSign.getComponent(cc.Button).interactable = true;\r\n                } else {\r\n                    nodSign.getChildByName('nodNormal').active = true;\r\n                    nodSign.getChildByName('nodSigned').active = true;\r\n                    nodSign.getComponent(cc.Button).interactable = false;\r\n                }\r\n            } else if (data.slot == param.now) {\r\n                // 现在的签到\r\n                nodSign.getChildByName('nodAddSign').active = false;\r\n                nodSign.getChildByName('nodCurrDay').active = true;\r\n                nodSign.getChildByName('nodNormal').active = true;\r\n\r\n                if (data.signed === 0) {\r\n                    nodSign.getChildByName('nodSigned').active = false;\r\n                    nodSign.getComponent(cc.Button).interactable = false;\r\n                    this.btnSign.interactable = true;\r\n                } else {\r\n                    nodSign.getChildByName('nodSigned').active = true;\r\n                    nodSign.getComponent(cc.Button).interactable = false;\r\n                    this.btnSign.node.getChildByName('label').getComponent(cc.Label).string = '已签到';\r\n                    this.btnSign.interactable = false;\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    // 设置签到奖励\r\n    showSignReward(nodSign, rewardList) {\r\n        if (rewardList.length > 1) {\r\n            // 多个奖励\r\n            nodSign.getChildByName('icon').getComponent(cc.Sprite).spriteFrame = this.spfBox;\r\n            nodSign.getChildByName('name').getComponent(cc.Label).string = '小礼盒';\r\n        } else if (rewardList.length == 1) {\r\n            let prop: PGoods = rewardList[0];\r\n\r\n            // 设置图标\r\n            let spriteFrame;\r\n            switch (prop.goodsId) {\r\n                case 11:\r\n                    spriteFrame = this.spfCoin;\r\n                    break;\r\n                case 1:\r\n                    spriteFrame = this.spfBuff1;\r\n                    break;\r\n                case 2:\r\n                    spriteFrame = this.spfBuff2;\r\n                    break;\r\n                case 3:\r\n                    spriteFrame = this.spfBuff3;\r\n                    break;\r\n                case 4:\r\n                    spriteFrame = this.spfBuff4;\r\n                    break;\r\n            }\r\n            nodSign.getChildByName('icon').getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n\r\n            // 设置数量\r\n            nodSign.getChildByName('name').getComponent(cc.Label).string = '数量x' + prop.goodsNum;\r\n        }\r\n\r\n    }\r\n    canLoadUIGetProp;\r\n    // 显示签到结果\r\n    showSign(param: SignInSignS2C) {\r\n        let nodSign = this.nodSigns.children[param.slot - 1];\r\n        nodSign.getChildByName('nodSigned').active = true;\r\n        nodSign.getChildByName('nodAddSign').active = false;\r\n        nodSign.getChildByName('nodNormal').active = true;\r\n        nodSign.getComponent(cc.Button).interactable = false;\r\n\r\n        if (param.slot === this.currDay) {\r\n            this.btnSign.node.getChildByName('label').getComponent(cc.Label).string = '已签到';\r\n            this.btnSign.interactable = false;\r\n        }\r\n        if (!this.canLoadUIGetProp) {\r\n            return;\r\n        }\r\n        this.canLoadUIGetProp = false;\r\n        UIFunc.openUI('UIGetProp', (node) => {\r\n            this.canLoadUIGetProp = true;\r\n            node.getComponent('UIGetProp').moreProp(param.reward, () => {\r\n                UIFunc.closeUI('UIGetProp', () => { })\r\n            });\r\n        })\r\n    }\r\n\r\n    share(slotIndex, isDouble?) {\r\n        GamePersist.INSTANCE.btnAudio_1();\r\n        ShareManager.Instance.share(6, { slotIndex: slotIndex, isDouble: isDouble });\r\n    }\r\n\r\n    // 观看视频\r\n    showAd(slotIndex, isDouble?) {\r\n        if (window['Partner'].supportAd()) {\r\n            GamePersist.INSTANCE.blockInput();\r\n            window['Partner'].showVideoAd(() => {\r\n                ShareManager.Instance.notifySign({ slotIndex: slotIndex, isDouble: isDouble });\r\n            }, () => {\r\n                this.share(slotIndex, isDouble);\r\n            });\r\n        } else {\r\n            cc.log('不支持广告');\r\n            ShareManager.Instance.notifySign({ slotIndex: slotIndex, isDouble: isDouble });\r\n        }\r\n    }\r\n\r\n    // 签到\r\n    onBtnSign(slotIndex) {\r\n        if (slotIndex === this.currDay) {\r\n            if (!this.doubleStatus) {\r\n                // 一倍签到\r\n                ShareManager.Instance.notifySign({ slotIndex: slotIndex, isDouble: 0 });\r\n            } else {\r\n                // 双倍签到\r\n                this.showAd(slotIndex, 1);\r\n            }\r\n            return;\r\n        }\r\n        // 补签\r\n        this.showAd(slotIndex);\r\n    }\r\n\r\n    private onNotify(target, tag, param) {\r\n        var self = target;\r\n        if (tag == Message.SIGN_List) {\r\n            self.showSignList(param);\r\n        } else if (tag == Message.SIGN_RESULT) {\r\n            self.showSign(param);\r\n        }\r\n    }\r\n\r\n    public btnListener(event: cc.Event.EventTouch) {\r\n        var target = event.target;\r\n        target.scale = 1;\r\n        switch (target.name) {\r\n            case 'btnBack':\r\n                UIFunc.closeUI('UISign', () => { });\r\n                break;\r\n            case 'nodSign1':\r\n                this.onBtnSign(1);\r\n                break;\r\n            case 'nodSign2':\r\n                this.onBtnSign(2);\r\n                break;\r\n            case 'nodSign3':\r\n                this.onBtnSign(3);\r\n                break;\r\n            case 'nodSign4':\r\n                this.onBtnSign(4);\r\n                break;\r\n            case 'nodSign5':\r\n                this.onBtnSign(5);\r\n                break;\r\n            case 'nodSign6':\r\n                this.onBtnSign(6);\r\n                break;\r\n            case 'nodSign7':\r\n                this.onBtnSign(7);\r\n                break;\r\n            case 'btnSign':\r\n                this.onBtnSign(this.currDay);\r\n                break;\r\n        }\r\n    }\r\n}"]}